<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CALICE_USERLIB: Ahc2Mapper.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_36843d1d4246be2b2ac1dd04c3c30114.html">calice_userlib</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_57be4fcabe5c93cdea47fb40369601ff.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5c6df5fb33f97ab441a1c2f4eff4b5dd.html">Mapping</a>
  </div>
</div>
<div class="contents">
<h1>Ahc2Mapper.hh</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef Ahc2Mapper_hh</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define Ahc2Mapper_hh</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;lcio.h&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;EVENT/LCCollection.h&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;Mapper.hh&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;CaliceException.hh&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>CALICE {
<a name="l00016"></a>00016 
<a name="l00044"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html">00044</a>   <span class="keyword">class </span><a class="code" href="classCALICE_1_1Ahc2Mapper.html" title="AHCAL implementation of Mapper class.">Ahc2Mapper</a> : <span class="keyword">public</span> <a class="code" href="classCALICE_1_1Mapper.html" title="Mapping for CALICE detectors (currently: HCAL support only).">Mapper</a> {
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="keyword">public</span>:
<a name="l00047"></a>00047 
<a name="l00048"></a>00048     <a class="code" href="classCALICE_1_1Ahc2Mapper.html" title="AHCAL implementation of Mapper class.">Ahc2Mapper</a>() {
<a name="l00049"></a>00049 
<a name="l00050"></a>00050       clear();
<a name="l00051"></a>00051 
<a name="l00052"></a>00052       <span class="keyword">const</span> std::string CellIDEncoding(<span class="stringliteral">&quot;M:3,S-1:3,I:9,J:9,K-1:6&quot;</span>);
<a name="l00053"></a>00053       <span class="keyword">const</span> std::string ModuleEncoding(<span class="stringliteral">&quot;module:6,chip:4,chan:6,SiPM:16&quot;</span>);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055       <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__CellIDgroup.html#ga945f56e77ed47b76b5cb650df056ab83" title="set a new cell ID encoding string if an empty string is given the function will use...">setCellIDEncoding</a>( CellIDEncoding );
<a name="l00056"></a>00056       <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#ga7160e4ea856ff557189fd52a4de92d2d" title="set a new Module tile encoding string if an empty string is given the function will...">setModuleEncoding</a>( ModuleEncoding );
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 
<a name="l00079"></a><a class="code" href="group__CellIDgroup.html#ga8dd1fc186e1ad4501115fdeb96d434d7">00079</a>     <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga8dd1fc186e1ad4501115fdeb96d434d7" title="generate (Mokka) cellID from module, chip, channel">getCellIDFromModChipChan</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel)<span class="keyword"> const </span>{
<a name="l00080"></a>00080       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__CellIDgroup.html#ga98194da015b87fdf07f0a62da5b8c9e5" title="get CellID from triple I,J,K">getCellID</a>(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6" title="I of (Mokka) cellID.">getI</a>(module,chip,channel), <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9" title="J of (Mokka) cellID.">getJ</a>(module,chip,channel), <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856" title="K of (Mokka) cellID.">getK</a>(module));
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00096"></a><a class="code" href="group__CellIDgroup.html#ga3094adcb1a9a51207cb766f8f8da9460">00096</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga3094adcb1a9a51207cb766f8f8da9460" title="module number from (Mokka) CellID">getModuleFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00097"></a>00097       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(cellID));
<a name="l00098"></a>00098     }
<a name="l00110"></a><a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d">00110</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00111"></a>00111       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getCrateFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getSlotFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getFeFromDAQID(DAQchannel));
<a name="l00112"></a>00112     }
<a name="l00124"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e">00124</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fe)<span class="keyword"> const </span>{
<a name="l00125"></a>00125 
<a name="l00126"></a>00126       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexModuleConnection(crate,slot,fe);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       <span class="keywordflow">if</span> (! valid(index, _connectionAvailable) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid DAQ connection value (crate,slot,fe)&quot;</span>);
<a name="l00129"></a>00129 
<a name="l00130"></a>00130       <span class="keywordflow">return</span> _moduleVconnection.at(index);
<a name="l00131"></a>00131     }
<a name="l00141"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a43d10d6fa909332e4744fce0986b9bc4">00141</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a43d10d6fa909332e4744fce0986b9bc4" title="module number from K">getModule</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00142"></a>00142       <span class="keywordflow">if</span> (! valid(k,_kAvailable) ) {
<a name="l00143"></a>00143         std::ostringstream errorMessage;
<a name="l00144"></a>00144         errorMessage &lt;&lt; <span class="stringliteral">&quot;invalid K value &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; using encoding string: &quot;</span> &lt;&lt; <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__CellIDgroup.html#ga240d50257f1971269a051856b328285c" title="get the current cell ID encoding string">getCellIDEncoding</a>();
<a name="l00145"></a>00145         <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(errorMessage.str());
<a name="l00146"></a>00146       }
<a name="l00147"></a>00147       <span class="keywordflow">return</span> _moduleVk.at(k);
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 
<a name="l00163"></a><a class="code" href="group__CellIDgroup.html#gaa315bfe2512008cc074dbdf8009c0d57">00163</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#gaa315bfe2512008cc074dbdf8009c0d57" title="get module (number) in which this cell is included from (Mokka) cellID">getModuleFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID, <span class="keywordtype">bool</span> &amp;valid)<span class="keyword"> const </span>{
<a name="l00164"></a>00164       <span class="keywordflow">return</span> getModuleFromIndex(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa468f8c91286f9452202e0de9dc86179" title="get a compact index for storing data in vectors">getIndexByCellID</a>(cellID),valid);
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 
<a name="l00179"></a><a class="code" href="group__DAQgroup.html#ga1665e9e58c886d9506773a7f6964f7eb">00179</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#ga1665e9e58c886d9506773a7f6964f7eb" title="get module (number) in which this (DAQ) channel is included">getModuleFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel, <span class="keywordtype">bool</span> &amp;valid)<span class="keyword"> const </span>{
<a name="l00180"></a>00180       <span class="keywordflow">return</span> getModuleFromIndex(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8503c24f6eab43e134845efc48654908" title="get a compact index for storing data in vectors">getIndexByDAQID</a>(DAQchannel),valid);
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182 
<a name="l00195"></a><a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5">00195</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID, <span class="keywordtype">bool</span> &amp;valid)<span class="keyword"> const </span>{
<a name="l00196"></a>00196       <span class="keywordflow">return</span> getModuleFromIndex(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3471e5014da85986b145f08b977d2e94" title="get a compact index for storing data in vectors">getIndexByModuleID</a>(moduleID),valid);
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00211"></a><a class="code" href="group__CellIDgroup.html#ga08318bfa0005d4c792fa6a24bb270635">00211</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga08318bfa0005d4c792fa6a24bb270635" title="chip number from (Mokka) CellID">getChipFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00212"></a>00212 
<a name="l00213"></a>00213       <span class="comment">//std::cout &lt;&lt; &quot;Mapper I &quot; &lt;&lt; getDecoder()-&gt;getIFromCellID(cellID) &lt;&lt; &quot; J &quot; &lt;&lt; getDecoder()-&gt;getJFromCellID(cellID) &lt;&lt; &quot; K &quot; &lt;&lt; getDecoder()-&gt;getKFromCellID(cellID) &lt;&lt; std::endl;</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3b4555ddb636f3a1def55d7e21248b95" title="chip number from triple I, J, K">getChip</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(cellID));
<a name="l00216"></a>00216     }
<a name="l00228"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3b4555ddb636f3a1def55d7e21248b95">00228</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3b4555ddb636f3a1def55d7e21248b95" title="chip number from triple I, J, K">getChip</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k));
<a name="l00231"></a>00231       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexIJ(i,j);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233       <span class="keywordflow">if</span> ( ! valid(index,_ijAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid i,j&quot;</span>);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235       <span class="keywordflow">return</span> getChipFromChanIndex( _chanVij.at(moduleTypeIndex).at(index) );
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 
<a name="l00250"></a><a class="code" href="group__CellIDgroup.html#ga4142abdfc361e05889c41f08542cdc28">00250</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga4142abdfc361e05889c41f08542cdc28" title="channel number from (Mokka) CellID">getChanFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00251"></a>00251       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a9e2aa9c28a73ef59895d251604c6cfbb" title="chip number from triple I, J, K">getChan</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(cellID));
<a name="l00252"></a>00252     }
<a name="l00264"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a9e2aa9c28a73ef59895d251604c6cfbb">00264</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a9e2aa9c28a73ef59895d251604c6cfbb" title="chip number from triple I, J, K">getChan</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k));
<a name="l00267"></a>00267       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexIJ(i,j);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269       <span class="keywordflow">if</span> ( ! valid(index,_ijAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid i,j&quot;</span>);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271       <span class="keywordflow">return</span> getChanFromChanIndex( _chanVij.at(moduleTypeIndex).at(index) );
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00286"></a><a class="code" href="group__CellIDgroup.html#ga8befbda432dc5e3ab8614c39a466e5b7">00286</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga8befbda432dc5e3ab8614c39a466e5b7" title="crate number from (Mokka) CellID">getCrateFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00287"></a>00287       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a085945b3737a8a6c55a4db7c441e9808" title="crate number from module number">getCrate</a>(<a class="code" href="group__CellIDgroup.html#ga3094adcb1a9a51207cb766f8f8da9460" title="module number from (Mokka) CellID">getModuleFromCellID</a>(cellID));
<a name="l00288"></a>00288     }
<a name="l00300"></a><a class="code" href="group__ModuleIDgroup.html#ga383239ee7a35f35cec52e6dbbac0ecf9">00300</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga383239ee7a35f35cec52e6dbbac0ecf9" title="crate number from Module cell ID">getCrateFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00301"></a>00301       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a085945b3737a8a6c55a4db7c441e9808" title="crate number from module number">getCrate</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID));
<a name="l00302"></a>00302     }
<a name="l00312"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a085945b3737a8a6c55a4db7c441e9808">00312</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a085945b3737a8a6c55a4db7c441e9808" title="crate number from module number">getCrate</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module)<span class="keyword"> const </span>{
<a name="l00313"></a>00313       <span class="keywordflow">if</span> (! valid(module,_moduleAvailable) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid module&quot;</span>);
<a name="l00314"></a>00314       <span class="keywordflow">return</span> getCrateFromModuleConnectionIndex(_connectionVmodule.at(module));
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
<a name="l00329"></a><a class="code" href="group__CellIDgroup.html#gadd39bce577220342c23dae1be9fb8795">00329</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#gadd39bce577220342c23dae1be9fb8795" title="slot number from (Mokka) CellID">getSlotFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00330"></a>00330       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8efe9ffb7828059f261b6321bc57f8d1" title="slot number from module number">getSlot</a>(<a class="code" href="group__CellIDgroup.html#ga3094adcb1a9a51207cb766f8f8da9460" title="module number from (Mokka) CellID">getModuleFromCellID</a>(cellID));
<a name="l00331"></a>00331     }
<a name="l00343"></a><a class="code" href="group__ModuleIDgroup.html#ga63389f8a99a62439bcebee65054d1934">00343</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga63389f8a99a62439bcebee65054d1934" title="slot number from Module cell ID">getSlotFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00344"></a>00344       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8efe9ffb7828059f261b6321bc57f8d1" title="slot number from module number">getSlot</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID));
<a name="l00345"></a>00345     }
<a name="l00355"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8efe9ffb7828059f261b6321bc57f8d1">00355</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8efe9ffb7828059f261b6321bc57f8d1" title="slot number from module number">getSlot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module)<span class="keyword"> const </span>{
<a name="l00356"></a>00356       <span class="keywordflow">if</span> ( ! valid(module,_moduleAvailable) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid module&quot;</span>);
<a name="l00357"></a>00357       <span class="keywordflow">return</span> getSlotFromModuleConnectionIndex(_connectionVmodule.at(module));
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 
<a name="l00373"></a><a class="code" href="group__CellIDgroup.html#gab972133c9f5f2cc3fad4386f2c477124">00373</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#gab972133c9f5f2cc3fad4386f2c477124" title="front end number from (Mokka) CellID">getFeFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00374"></a>00374       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aba331d42b7ba82dd24f2ee6843d704c4" title="front end number from module number">getFe</a>(<a class="code" href="group__CellIDgroup.html#ga3094adcb1a9a51207cb766f8f8da9460" title="module number from (Mokka) CellID">getModuleFromCellID</a>(cellID));
<a name="l00375"></a>00375     }
<a name="l00387"></a><a class="code" href="group__ModuleIDgroup.html#ga6fd4831ef41ec27f81d52052c7d30ec8">00387</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga6fd4831ef41ec27f81d52052c7d30ec8" title="front end number from Module cell ID">getFeFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00388"></a>00388       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aba331d42b7ba82dd24f2ee6843d704c4" title="front end number from module number">getFe</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID));
<a name="l00389"></a>00389     }
<a name="l00399"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#aba331d42b7ba82dd24f2ee6843d704c4">00399</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aba331d42b7ba82dd24f2ee6843d704c4" title="front end number from module number">getFe</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module)<span class="keyword"> const </span>{
<a name="l00400"></a>00400       <span class="keywordflow">if</span> ( ! valid(module,_moduleAvailable) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid module&quot;</span>);
<a name="l00401"></a>00401       <span class="keywordflow">return</span> getFeFromModuleConnectionIndex(_connectionVmodule.at(module));
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00416"></a><a class="code" href="group__ModuleIDgroup.html#ga7ab442ef9a5832396039bd10137990c1">00416</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga7ab442ef9a5832396039bd10137990c1" title="I of (Mokka) cellID.">getIFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00417"></a>00417       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6" title="I of (Mokka) cellID.">getI</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromModuleID(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromModuleID(moduleID));
<a name="l00418"></a>00418     }
<a name="l00430"></a><a class="code" href="group__DAQgroup.html#gafd7ca491e5a37cc2c180eb4c0d2a835e">00430</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#gafd7ca491e5a37cc2c180eb4c0d2a835e" title="I of (Mokka) cellID.">getIFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00431"></a>00431       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6" title="I of (Mokka) cellID.">getI</a>(<a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromDAQID(DAQchannel));
<a name="l00432"></a>00432     }
<a name="l00444"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6">00444</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6" title="I of (Mokka) cellID.">getI</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan)<span class="keyword"> const </span>{
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00447"></a>00447       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexChan(chip,chan);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449       <span class="keywordflow">if</span> ( ! valid(index,_chipChanAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid chip, channel&quot;</span>);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451       <span class="keywordflow">return</span> getIFromIJIndex( _ijVchan.at(moduleTypeIndex).at(index) );
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 
<a name="l00465"></a><a class="code" href="group__ModuleIDgroup.html#gac57ab59005e030c42251284db1a7e70b">00465</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#gac57ab59005e030c42251284db1a7e70b" title="J of (Mokka) cellID.">getJFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00466"></a>00466       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9" title="J of (Mokka) cellID.">getJ</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromModuleID(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromModuleID(moduleID));
<a name="l00467"></a>00467     }
<a name="l00479"></a><a class="code" href="group__DAQgroup.html#ga191d48405470d3204fe6cd89dec6a9e9">00479</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#ga191d48405470d3204fe6cd89dec6a9e9" title="J of (Mokka) cellID.">getJFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00480"></a>00480       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9" title="J of (Mokka) cellID.">getJ</a>(<a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromDAQID(DAQchannel));
<a name="l00481"></a>00481     }
<a name="l00493"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9">00493</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9" title="J of (Mokka) cellID.">getJ</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> chan)<span class="keyword"> const </span>{
<a name="l00494"></a>00494 
<a name="l00495"></a>00495       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00496"></a>00496       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexChan(chip,chan);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       <span class="keywordflow">if</span> ( ! valid(index,_chipChanAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid chip, channel&quot;</span>);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500       <span class="keywordflow">return</span> getJFromIJIndex( _ijVchan.at(moduleTypeIndex).at(index) );
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502 
<a name="l00514"></a><a class="code" href="group__ModuleIDgroup.html#ga6f756f373297dbcdd0a6d7a3e7403949">00514</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga6f756f373297dbcdd0a6d7a3e7403949" title="K of (Mokka) cellID.">getKFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00515"></a>00515       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856" title="K of (Mokka) cellID.">getK</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID));
<a name="l00516"></a>00516     }
<a name="l00528"></a><a class="code" href="group__DAQgroup.html#ga59ffe1cd3d129e428cf654ff12ce8a4b">00528</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#ga59ffe1cd3d129e428cf654ff12ce8a4b" title="K of (Mokka) cellID.">getKFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00529"></a>00529       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856" title="K of (Mokka) cellID.">getK</a>(<a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(DAQchannel));
<a name="l00530"></a>00530     }
<a name="l00540"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856">00540</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856" title="K of (Mokka) cellID.">getK</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module)<span class="keyword"> const </span>{
<a name="l00541"></a>00541       <span class="keywordflow">if</span> (! valid(module,_moduleAvailable) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid module&quot;</span>);
<a name="l00542"></a>00542       <span class="keywordflow">return</span> _kVmodule.at(module);
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 
<a name="l00558"></a><a class="code" href="group__CellIDgroup.html#ga017ec921a85f3d1efda814bc633a81e7">00558</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#ga017ec921a85f3d1efda814bc633a81e7" title="get cell size in I direction of (Mokka) CellID coordinate">getISizeFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00559"></a>00559       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#acf96a7b43c787c30876d5a3b8df68a5c" title="get cell size in I direction of (Mokka) CellID coordinate">getISizeFromIJK</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(cellID));
<a name="l00560"></a>00560     }
<a name="l00572"></a><a class="code" href="group__ModuleIDgroup.html#gabe0726ad1cf3a8ea201df08236accc09">00572</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#gabe0726ad1cf3a8ea201df08236accc09" title="get cell size in I direction of (Mokka) CellID coordinate">getISizeFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00573"></a>00573       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a52d8a9ca0d55fc87f92d339ec763b514" title="get cell size in I direction of (Mokka) CellID coordinate">getISize</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromModuleID(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromModuleID(moduleID));
<a name="l00574"></a>00574     }
<a name="l00586"></a><a class="code" href="group__DAQgroup.html#gaf3628cbe2a8211ed24550ec01704d1d5">00586</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#gaf3628cbe2a8211ed24550ec01704d1d5" title="get cell size in I direction of (Mokka) CellID coordinate">getISizeFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00587"></a>00587       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a52d8a9ca0d55fc87f92d339ec763b514" title="get cell size in I direction of (Mokka) CellID coordinate">getISize</a>(<a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromDAQID(DAQchannel));
<a name="l00588"></a>00588     }
<a name="l00600"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#acf96a7b43c787c30876d5a3b8df68a5c">00600</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#acf96a7b43c787c30876d5a3b8df68a5c" title="get cell size in I direction of (Mokka) CellID coordinate">getISizeFromIJK</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00601"></a>00601       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a52d8a9ca0d55fc87f92d339ec763b514" title="get cell size in I direction of (Mokka) CellID coordinate">getISize</a>(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k),<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3b4555ddb636f3a1def55d7e21248b95" title="chip number from triple I, J, K">getChip</a>(i,j,k),<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a9e2aa9c28a73ef59895d251604c6cfbb" title="chip number from triple I, J, K">getChan</a>(i,j,k));
<a name="l00602"></a>00602     }
<a name="l00614"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a52d8a9ca0d55fc87f92d339ec763b514">00614</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a52d8a9ca0d55fc87f92d339ec763b514" title="get cell size in I direction of (Mokka) CellID coordinate">getISize</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan)<span class="keyword"> const </span>{
<a name="l00615"></a>00615 
<a name="l00616"></a>00616       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00617"></a>00617       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexChan(chip,chan);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619       <span class="keywordflow">if</span> ( ! valid(index,_chipChanAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid chip, channel&quot;</span>);
<a name="l00620"></a>00620 
<a name="l00621"></a>00621       <span class="keywordflow">return</span> _sizeIVchan.at(moduleTypeIndex).at(index);
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 
<a name="l00636"></a><a class="code" href="group__CellIDgroup.html#gaef8836f7e3a9f8dad82ba675707f1ed2">00636</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__CellIDgroup.html#gaef8836f7e3a9f8dad82ba675707f1ed2" title="get cell size in J direction of (Mokka) CellID coordinate">getJSizeFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00637"></a>00637       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a255332c0e41298be7325bb1a91658abb" title="get cell size in J direction of (Mokka) CellID coordinate">getJSizeFromIJK</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(cellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(cellID));
<a name="l00638"></a>00638     }
<a name="l00650"></a><a class="code" href="group__ModuleIDgroup.html#ga8734e5c40688c8fd51168d10ed7d3dbf">00650</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__ModuleIDgroup.html#ga8734e5c40688c8fd51168d10ed7d3dbf" title="get cell size in J direction of (Mokka) CellID coordinate">getJSizeFromModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> moduleID)<span class="keyword"> const </span>{
<a name="l00651"></a>00651       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2a086e94e80f98fd77ba49656a42f036" title="get cell size in J direction of (Mokka) CellID coordinate">getJSize</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__ModuleIDgroup.html#gae975735e651e10b6cb36822dd68787b5" title="get module (number) from this (module) channel ID">getModuleFromModuleID</a>(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromModuleID(moduleID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromModuleID(moduleID));
<a name="l00652"></a>00652     }
<a name="l00664"></a><a class="code" href="group__DAQgroup.html#gac4441dbb533aeab4e86b0fc4fd1b9d41">00664</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__DAQgroup.html#gac4441dbb533aeab4e86b0fc4fd1b9d41" title="get cell size in J direction of (Mokka) CellID coordinate">getJSizeFromDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DAQchannel)<span class="keyword"> const </span>{
<a name="l00665"></a>00665       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2a086e94e80f98fd77ba49656a42f036" title="get cell size in J direction of (Mokka) CellID coordinate">getJSize</a>(<a class="code" href="group__DAQgroup.html#ga4f88e701c504dfe819b67142247ebd1d" title="module number from DAQ channel ID">getModuleFromDAQID</a>(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChipFromDAQID(DAQchannel),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getChannelFromDAQID(DAQchannel));
<a name="l00666"></a>00666     }
<a name="l00678"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a255332c0e41298be7325bb1a91658abb">00678</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a255332c0e41298be7325bb1a91658abb" title="get cell size in J direction of (Mokka) CellID coordinate">getJSizeFromIJK</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00679"></a>00679       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2a086e94e80f98fd77ba49656a42f036" title="get cell size in J direction of (Mokka) CellID coordinate">getJSize</a>(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k),<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3b4555ddb636f3a1def55d7e21248b95" title="chip number from triple I, J, K">getChip</a>(i,j,k),<a class="code" href="classCALICE_1_1Ahc2Mapper.html#a9e2aa9c28a73ef59895d251604c6cfbb" title="chip number from triple I, J, K">getChan</a>(i,j,k));
<a name="l00680"></a>00680     }
<a name="l00692"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2a086e94e80f98fd77ba49656a42f036">00692</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2a086e94e80f98fd77ba49656a42f036" title="get cell size in J direction of (Mokka) CellID coordinate">getJSize</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan)<span class="keyword"> const </span>{
<a name="l00693"></a>00693 
<a name="l00694"></a>00694       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00695"></a>00695       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexChan(chip,chan);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697       <span class="keywordflow">if</span> ( ! valid(index,_chipChanAvailable.at(moduleTypeIndex)) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid chip, channel&quot;</span>);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699       <span class="keywordflow">return</span> _sizeJVchan.at(moduleTypeIndex).at(index);
<a name="l00700"></a>00700     }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 
<a name="l00703"></a>00703 
<a name="l00704"></a>00704 
<a name="l00718"></a><a class="code" href="group__VirtualCellID.html#ga0fc134cbde1c93ca7c5a5260ad41c5e5">00718</a>     <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#ga0fc134cbde1c93ca7c5a5260ad41c5e5" title="return identifying index of cell">getTrueCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> virtualCellIndex)<span class="keyword"> const </span>{
<a name="l00719"></a>00719       <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__CellIDgroup.html#ga98194da015b87fdf07f0a62da5b8c9e5" title="get CellID from triple I,J,K">getCellID</a>(<a class="code" href="group__VirtualCellID.html#ga49714e5b6a17352138793e17cbc5a24b" title="return I of identifying index of cell">getTrueIFromCellID</a>(virtualCellIndex), <a class="code" href="group__VirtualCellID.html#gaf19cdefede20837030d17562c35a5222" title="return J of identifying index of cell">getTrueJFromCellID</a>(virtualCellIndex), <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(virtualCellIndex));
<a name="l00720"></a>00720     }
<a name="l00721"></a>00721 
<a name="l00737"></a><a class="code" href="group__VirtualCellID.html#gabd42a7d81b91fe0f3da3883b009a453c">00737</a>     <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#gabd42a7d81b91fe0f3da3883b009a453c" title="return identifying index of cell">getTrueCellID</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00738"></a>00738       <span class="keywordflow">return</span> <a class="code" href="group__VirtualCellID.html#ga0fc134cbde1c93ca7c5a5260ad41c5e5" title="return identifying index of cell">getTrueCellID</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getCellID(i,j,k));
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740 
<a name="l00756"></a><a class="code" href="group__VirtualCellID.html#ga49714e5b6a17352138793e17cbc5a24b">00756</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#ga49714e5b6a17352138793e17cbc5a24b" title="return I of identifying index of cell">getTrueIFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> virtualCellID)<span class="keyword"> const </span>{
<a name="l00757"></a>00757       <span class="keywordflow">return</span> <a class="code" href="group__VirtualCellID.html#ga449dfd031ca7a0c7914ec3e675beacb7" title="return I of identifying index of cell">getTrueIFromIJK</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(virtualCellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(virtualCellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(virtualCellID));
<a name="l00758"></a>00758     }
<a name="l00776"></a><a class="code" href="group__VirtualCellID.html#ga449dfd031ca7a0c7914ec3e675beacb7">00776</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#ga449dfd031ca7a0c7914ec3e675beacb7" title="return I of identifying index of cell">getTrueIFromIJK</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00777"></a>00777       <span class="keywordflow">return</span> <a class="code" href="group__VirtualCellID.html#ga3b0f264daebc7a164159919beff4566d" title="return I of identifying index of cell">getTrueI</a>(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k),i,j);
<a name="l00778"></a>00778     }
<a name="l00796"></a><a class="code" href="group__VirtualCellID.html#ga3b0f264daebc7a164159919beff4566d">00796</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#ga3b0f264daebc7a164159919beff4566d" title="return I of identifying index of cell">getTrueI</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)<span class="keyword"> const </span>{
<a name="l00797"></a>00797 
<a name="l00798"></a>00798       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00799"></a>00799       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexIJ(i,j);
<a name="l00800"></a>00800 
<a name="l00801"></a>00801       <span class="keywordflow">if</span> ( ! ( valid(index,_ijSecondaryAvailable.at(moduleTypeIndex)) || valid(index,_ijAvailable.at(moduleTypeIndex))) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid i,j&quot;</span>);
<a name="l00802"></a>00802 
<a name="l00803"></a>00803       <span class="keywordflow">return</span> getIFromIJIndex( _ijVchan.at(moduleTypeIndex).at( _chanVij.at(moduleTypeIndex).at(index) ) );
<a name="l00804"></a>00804     }
<a name="l00805"></a>00805 
<a name="l00821"></a><a class="code" href="group__VirtualCellID.html#gaf19cdefede20837030d17562c35a5222">00821</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#gaf19cdefede20837030d17562c35a5222" title="return J of identifying index of cell">getTrueJFromCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> virtualCellID)<span class="keyword"> const </span>{
<a name="l00822"></a>00822       <span class="keywordflow">return</span> <a class="code" href="group__VirtualCellID.html#gaa3350094fe5d1a517c8e390acdc0b84a" title="return J of identifying index of cell">getTrueJFromIJK</a>(<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getIFromCellID(virtualCellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getJFromCellID(virtualCellID),<a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;getKFromCellID(virtualCellID));
<a name="l00823"></a>00823     }
<a name="l00841"></a><a class="code" href="group__VirtualCellID.html#gaa3350094fe5d1a517c8e390acdc0b84a">00841</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#gaa3350094fe5d1a517c8e390acdc0b84a" title="return J of identifying index of cell">getTrueJFromIJK</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k)<span class="keyword"> const </span>{
<a name="l00842"></a>00842       <span class="keywordflow">return</span> <a class="code" href="group__VirtualCellID.html#ga2de81498f4976911c8ee656c2389dc9d" title="return J of identifying index of cell">getTrueJ</a>(<a class="code" href="classCALICE_1_1Ahc2Mapper.html#aed5a4c86115e9048a4cded8429f85e4e" title="module number from triple crate, slot, fe">getModule</a>(k),i,j);
<a name="l00843"></a>00843     }
<a name="l00861"></a><a class="code" href="group__VirtualCellID.html#ga2de81498f4976911c8ee656c2389dc9d">00861</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__VirtualCellID.html#ga2de81498f4976911c8ee656c2389dc9d" title="return J of identifying index of cell">getTrueJ</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)<span class="keyword"> const </span>{
<a name="l00862"></a>00862 
<a name="l00863"></a>00863       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeIndex = getModuleTypeIndex(module);
<a name="l00864"></a>00864       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = getIndexIJ(i,j);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866       <span class="keywordflow">if</span> ( ! ( valid(index,_ijSecondaryAvailable.at(moduleTypeIndex)) || valid(index,_ijAvailable.at(moduleTypeIndex))) ) <span class="keywordflow">throw</span> <a class="code" href="classCALICE_1_1BadDataException.html" title="exception to be thrown when data leads to a conflict">BadDataException</a>(<span class="stringliteral">&quot;invalid i,j&quot;</span>);
<a name="l00867"></a>00867 
<a name="l00868"></a>00868       <span class="keywordflow">return</span> getJFromIJIndex( _ijVchan.at(moduleTypeIndex).at( _chanVij.at(moduleTypeIndex).at(index) ) );
<a name="l00869"></a>00869     }
<a name="l00870"></a>00870 
<a name="l00878"></a><a class="code" href="group__Range.html#ga9467908a1215cb7f440c7501dcd683ad">00878</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#ga9467908a1215cb7f440c7501dcd683ad" title="return maximum module number">getMaxModule</a>()<span class="keyword"> const </span>{
<a name="l00879"></a>00879       <span class="keywordflow">return</span> _nMod;
<a name="l00880"></a>00880     }
<a name="l00881"></a>00881 
<a name="l00889"></a><a class="code" href="group__Range.html#ga08fb8cac6c3c878e73c0b5d6f0066fb3">00889</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#ga08fb8cac6c3c878e73c0b5d6f0066fb3" title="return maximum chip number">getMaxChip</a>()<span class="keyword"> const </span>{
<a name="l00890"></a>00890       <span class="keywordflow">return</span> _nChip;
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892 
<a name="l00900"></a><a class="code" href="group__Range.html#ga856529fcaf100f6d61df791bfd19ff60">00900</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#ga856529fcaf100f6d61df791bfd19ff60" title="return maximum channel number">getMaxChannel</a>()<span class="keyword"> const </span>{
<a name="l00901"></a>00901       <span class="keywordflow">return</span> _nChan;
<a name="l00902"></a>00902     }
<a name="l00903"></a>00903 
<a name="l00911"></a><a class="code" href="group__Range.html#gab51db07386bc9b6b7f895fef1a633c67">00911</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#gab51db07386bc9b6b7f895fef1a633c67" title="return maximum I index">getMaxI</a>()<span class="keyword"> const </span>{
<a name="l00912"></a>00912       <span class="keywordflow">return</span> _nI;
<a name="l00913"></a>00913     }
<a name="l00921"></a><a class="code" href="group__Range.html#gabec47f8bfddf519fbb06cbc8fb35720e">00921</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#gabec47f8bfddf519fbb06cbc8fb35720e" title="return maximum J index">getMaxJ</a>()<span class="keyword"> const </span>{
<a name="l00922"></a>00922       <span class="keywordflow">return</span> _nJ;
<a name="l00923"></a>00923     }
<a name="l00931"></a><a class="code" href="group__Range.html#ga3c4dcdffcec214e9c690434596edb9ed">00931</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="group__Range.html#ga3c4dcdffcec214e9c690434596edb9ed" title="return maximum K index">getMaxK</a>()<span class="keyword"> const </span>{
<a name="l00932"></a>00932       <span class="keywordflow">return</span> _nK;
<a name="l00933"></a>00933     }
<a name="l00934"></a>00934 
<a name="l00946"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2665c4a607dec1613e91e89bb652195e">00946</a>     <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a2665c4a607dec1613e91e89bb652195e" title="fills all necessary mapping information">fill</a>(<span class="keyword">const</span> lcio::LCCollection* moduleDescriptionCol, <span class="keyword">const</span> lcio::LCCollection* moduleConnectionCol) {
<a name="l00947"></a>00947       <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a72a2159c191b2413a13408c2f9c24480" title="sets the module layout information in the class, module connection information will...">fillModuleDescription</a>(moduleDescriptionCol);
<a name="l00948"></a>00948       <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a24e7b07d1fbac2bc225a1af08fa52d38" title="sets the mapping information in the class, call after fillModuleDescription">fillModuleConnection</a>(moduleConnectionCol);
<a name="l00949"></a>00949     }
<a name="l00950"></a>00950 
<a name="l00958"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a6c3fa67ba92476bb559224f471d93e3c">00958</a>     <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a6c3fa67ba92476bb559224f471d93e3c" title="updates the mapping information in the class (possible after first fill only)">updateConnections</a>(<span class="keyword">const</span> lcio::LCCollection* moduleConnectionCol) {
<a name="l00959"></a>00959       <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a24e7b07d1fbac2bc225a1af08fa52d38" title="sets the mapping information in the class, call after fillModuleDescription">fillModuleConnection</a>(moduleConnectionCol);
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961 
<a name="l00969"></a>00969     <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8aa8a195c832a6dd6884f2363a76c962" title="print current data contents">print</a>(std::ostream &amp;ostream) <span class="keyword">const</span>;
<a name="l00970"></a>00970 
<a name="l00978"></a>00978     <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#ad8829596dc41165ed72dc2732510db77" title="print summary of current data contents">printStats</a>(std::ostream &amp;ostream) <span class="keyword">const</span>;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 
<a name="l00981"></a>00981   <span class="keyword">protected</span>:
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 
<a name="l00984"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa468f8c91286f9452202e0de9dc86179">00984</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa468f8c91286f9452202e0de9dc86179" title="get a compact index for storing data in vectors">getIndexByCellID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> cellID)<span class="keyword"> const </span>{
<a name="l00985"></a>00985       <a class="code" href="classCALICE_1_1DecoderSet.html" title="class containing decoders for the three CALICE coordinate systems">DecoderSet</a> *decoder = <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>();
<a name="l00986"></a>00986       <span class="comment">// check if k exists</span>
<a name="l00987"></a>00987       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = decoder-&gt;<a class="code" href="group__CellIDgroup.html#ga082e821a56c0490acc9d44a58cf285af" title="get K from (Mokka) CellID The right encoding string has to be set before.">getKFromCellID</a>(cellID);
<a name="l00988"></a>00988       <span class="keywordflow">if</span> ( ! valid(k,_kAvailable) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l00989"></a>00989 
<a name="l00990"></a>00990       <span class="comment">/* check if channel (i/j) lays inside this module</span>
<a name="l00991"></a>00991 <span class="comment">      * NOTE: to speed up, we assume at this place, that everything was filled right</span>
<a name="l00992"></a>00992 <span class="comment">      *       we assume that when K is available, also a module</span>
<a name="l00993"></a>00993 <span class="comment">      *       with a valid type belongs to this K</span>
<a name="l00994"></a>00994 <span class="comment">      */</span>
<a name="l00995"></a>00995       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ijIndex = getIndexIJ(decoder-&gt;<a class="code" href="group__CellIDgroup.html#ga3fdbb446bca5f7ba2636396e96c1ac9c" title="get I from (Mokka) CellID The right encoding string has to be set before.">getIFromCellID</a>(cellID), decoder-&gt;<a class="code" href="group__CellIDgroup.html#ga6325aee66a827df07d103b78a399ff5f" title="get J from (Mokka) CellID The right encoding string has to be set before.">getJFromCellID</a>(cellID));
<a name="l00996"></a>00996       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module = _moduleVk[k];
<a name="l00997"></a>00997       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleType = _typeVmodule[module];
<a name="l00998"></a>00998       <span class="keywordflow">if</span> ( ! valid( ijIndex, _ijAvailable[moduleType]) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l00999"></a>00999 
<a name="l01000"></a>01000       <span class="comment">// everything seems to be alright; let&apos;s return the compact index</span>
<a name="l01001"></a>01001       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chanIndex = _chanVij[moduleType][ijIndex];
<a name="l01002"></a>01002       <span class="keywordflow">return</span> getCompactIndex(module,getChipFromChanIndex(chanIndex),getChanFromChanIndex(chanIndex));
<a name="l01003"></a>01003 
<a name="l01004"></a>01004       <span class="comment">//     return getCompactIndex(getModuleFromCellID(cellID),_chanVij.at(getModuleTypeIndex(getModuleFromCellID(cellID))).at(getIndexIJ(getDecoder()-&gt;getIFromCellID(cellID),getDecoder()-&gt;getJFromCellID(cellID))));</span>
<a name="l01005"></a>01005     }
<a name="l01006"></a>01006 
<a name="l01007"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8503c24f6eab43e134845efc48654908">01007</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a8503c24f6eab43e134845efc48654908" title="get a compact index for storing data in vectors">getIndexByDAQID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ID)<span class="keyword"> const </span>{
<a name="l01008"></a>01008       <a class="code" href="classCALICE_1_1DecoderSet.html" title="class containing decoders for the three CALICE coordinate systems">DecoderSet</a> *decoder = <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>();
<a name="l01009"></a>01009 
<a name="l01010"></a>01010       <span class="comment">// check if crate exists</span>
<a name="l01011"></a>01011       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate = decoder-&gt;<a class="code" href="group__DAQgroup.html#ga25aea4dafa082da6847d988952710259" title="get crate from DAQ channel ID The right encoding string has to be set before.">getCrateFromDAQID</a>(ID);
<a name="l01012"></a>01012       <span class="keywordflow">if</span> ( ! valid(crate,_crateIndex) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014       <span class="comment">// check if slot exists</span>
<a name="l01015"></a>01015       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot = decoder-&gt;<a class="code" href="group__DAQgroup.html#gae695d7a267bbde471feeac8b1899b873" title="get slot from DAQ channel ID The right encoding string has to be set before.">getSlotFromDAQID</a>(ID);
<a name="l01016"></a>01016       <span class="keywordflow">if</span> ( ! valid(slot,_slotAvailable) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l01017"></a>01017 
<a name="l01018"></a>01018       <span class="comment">// check if there is a module for this crate/slot/fe</span>
<a name="l01019"></a>01019       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> connectionIndex = getIndexModuleConnection(crate,slot,decoder-&gt;<a class="code" href="group__DAQgroup.html#ga175464940f15c89b46495bff3c4537fa" title="get fe from DAQ channel ID The right encoding string has to be set before.">getFeFromDAQID</a>(ID));
<a name="l01020"></a>01020       <span class="keywordflow">if</span> ( ! valid(connectionIndex,_connectionAvailable) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022       <span class="comment">/*</span>
<a name="l01023"></a>01023 <span class="comment">      * NOTE: To speed up, we assume at this place, that everything was filled right.</span>
<a name="l01024"></a>01024 <span class="comment">      *       We assume, that when the connection is available, also a module</span>
<a name="l01025"></a>01025 <span class="comment">      *       with a valid type belongs to this connection.</span>
<a name="l01026"></a>01026 <span class="comment">      */</span>
<a name="l01027"></a>01027       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module  = _moduleVconnection[connectionIndex];
<a name="l01028"></a>01028       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip    = decoder-&gt;<a class="code" href="group__DAQgroup.html#ga64c278c9712e9417cddbf50f549e3ee4" title="get chip from DAQ channel ID The right encoding string has to be set before.">getChipFromDAQID</a>(ID);
<a name="l01029"></a>01029       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel = decoder-&gt;<a class="code" href="group__DAQgroup.html#ga2d7b8b445a2dcfe82b091a5dc9ceaa33" title="get channel from DAQ channel ID The right encoding string has to be set before.">getChannelFromDAQID</a>(ID);
<a name="l01030"></a>01030 
<a name="l01031"></a>01031       <span class="comment">// check if channel (chip/channel) lays inside this module</span>
<a name="l01032"></a>01032       <span class="keywordflow">if</span> ( ! valid( getIndexChan(chip,channel),
<a name="l01033"></a>01033       _chipChanAvailable[_typeVmodule[module]])
<a name="l01034"></a>01034     ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036     <span class="comment">// everything seems to be alright; let&apos;s return the compact index</span>
<a name="l01037"></a>01037     <span class="keywordflow">return</span> getCompactIndex(module,chip,channel);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039     <span class="comment">//      return getCompactIndex(getModule(getDecoder()-&gt;getCrateFromDAQID(ID),getDecoder()-&gt;getSlotFromDAQID(ID),getDecoder()-&gt;getFeFromDAQID(ID)),getDecoder()-&gt;getChipFromDAQID(ID),getDecoder()-&gt;getChannelFromDAQID(ID));</span>
<a name="l01040"></a>01040   }
<a name="l01041"></a>01041 
<a name="l01042"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3471e5014da85986b145f08b977d2e94">01042</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a3471e5014da85986b145f08b977d2e94" title="get a compact index for storing data in vectors">getIndexByModuleID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ID)<span class="keyword"> const </span>{
<a name="l01043"></a>01043     <a class="code" href="classCALICE_1_1DecoderSet.html" title="class containing decoders for the three CALICE coordinate systems">DecoderSet</a> *decoder = <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>();
<a name="l01044"></a>01044 
<a name="l01045"></a>01045     <span class="comment">// check if module is valid</span>
<a name="l01046"></a>01046     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module = decoder-&gt;<a class="code" href="group__ModuleIDgroup.html#ga8b95a2f04736868caf10e482eb948a37" title="get module from (Module) channel ID The right encoding string has to be set before...">getModuleFromModuleID</a>(ID);
<a name="l01047"></a>01047     <span class="keywordflow">if</span> ( ! valid(module,_moduleAvailable) ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1 ;
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <span class="comment">/* check if channel (chip/channel) lays inside this module</span>
<a name="l01050"></a>01050 <span class="comment">    * NOTE: To speed up, we assume at this place, that everything was filled right.</span>
<a name="l01051"></a>01051 <span class="comment">    *       We assume that an available module implies that it has a valid type.</span>
<a name="l01052"></a>01052 <span class="comment">    */</span>
<a name="l01053"></a>01053     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip = decoder-&gt;<a class="code" href="group__ModuleIDgroup.html#ga52836a07aa64bb2bae6daa35117cb74e" title="get chip from (Module) channel ID The right encoding string has to be set before...">getChipFromModuleID</a>(ID);
<a name="l01054"></a>01054     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel = decoder-&gt;<a class="code" href="group__ModuleIDgroup.html#ga78a17650cf220798f77b57244b65b94e" title="get channel from (Module) channel ID The right encoding string has to be set before...">getChannelFromModuleID</a>(ID);
<a name="l01055"></a>01055     <span class="keywordflow">if</span> ( ! valid( getIndexChan(chip, channel),
<a name="l01056"></a>01056     _chipChanAvailable[_typeVmodule[module]])
<a name="l01057"></a>01057   ) <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()+1;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059 
<a name="l01060"></a>01060   <span class="comment">// everything seems to be alright; let&apos;s return the compact index</span>
<a name="l01061"></a>01061   <span class="keywordflow">return</span> getCompactIndex(module,chip,channel);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063   <span class="comment">//      return getCompactIndex(getDecoder()-&gt;getModuleFromModuleID(ID),getDecoder()-&gt;getChipFromModuleID(ID),getDecoder()-&gt;getChannelFromModuleID(ID));</span>
<a name="l01064"></a>01064 }
<a name="l01065"></a>01065 
<a name="l01066"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d">01066</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>()<span class="keyword"> const </span>{
<a name="l01067"></a>01067   <span class="keywordflow">return</span> _nMod * _nChip * _nChan;
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a><a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa622a971f22c254c324a817355257bdc">01070</a> <span class="keywordtype">int</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa622a971f22c254c324a817355257bdc" title="get the cell ID of a certain compact index">getCellIDOfIndex</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01071"></a>01071   <span class="keywordflow">return</span> <a class="code" href="classCALICE_1_1Mapper.html#ac5989c1b376d938897806ee197f68375" title="get class which handles the bit en/decoding of the different IDs">getDecoder</a>()-&gt;<a class="code" href="group__CellIDgroup.html#ga98194da015b87fdf07f0a62da5b8c9e5" title="get CellID from triple I,J,K">getCellID</a>( <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a68be5ca889254e15dc98f8ded619d2d6" title="I of (Mokka) cellID.">getI</a>(getModuleFromCompactIndex(index),getChipFromCompactIndex(index),getChanFromCompactIndex(index)),
<a name="l01072"></a>01072   <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a50f1c14d9fb052f9ec91fc7611cf86a9" title="J of (Mokka) cellID.">getJ</a>(getModuleFromCompactIndex(index),getChipFromCompactIndex(index),getChanFromCompactIndex(index)),
<a name="l01073"></a>01073   <a class="code" href="classCALICE_1_1Ahc2Mapper.html#aa246f415919db6fa4a7139f0907f3856" title="K of (Mokka) cellID.">getK</a>(getModuleFromCompactIndex(index)) );
<a name="l01074"></a>01074 }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <span class="keyword">private</span>:
<a name="l01077"></a>01077 
<a name="l01078"></a>01078   <span class="keyword">typedef</span> std::map&lt;unsigned int,unsigned int&gt; indexMap_t ;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nChan;
<a name="l01081"></a>01081   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nChip;
<a name="l01082"></a>01082   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nFe;
<a name="l01083"></a>01083   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nSlot;
<a name="l01084"></a>01084   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _maxSlot;
<a name="l01085"></a>01085   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nCrate;
<a name="l01086"></a>01086 
<a name="l01087"></a>01087   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nMod;
<a name="l01088"></a>01088   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nModType;
<a name="l01089"></a>01089 
<a name="l01090"></a>01090   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nI;
<a name="l01091"></a>01091   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nJ;
<a name="l01092"></a>01092   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _nK;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094   <span class="keywordtype">bool</span> valid(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index, <span class="keyword">const</span> std::vector&lt;bool&gt; &amp;availableVec)<span class="keyword"> const </span>{
<a name="l01095"></a>01095     <span class="keywordflow">if</span> ( ! (index &lt; availableVec.size()) || ! availableVec[index] ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01096"></a>01096     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01097"></a>01097   }
<a name="l01098"></a>01098 
<a name="l01099"></a>01099   <span class="keywordtype">bool</span> valid(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index, <span class="keyword">const</span> indexMap_t &amp;indexMap)<span class="keyword"> const </span>{
<a name="l01100"></a>01100     indexMap_t::const_iterator indexIter = indexMap.find(index);
<a name="l01101"></a>01101     <span class="keywordflow">if</span> (indexIter == indexMap.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01102"></a>01102     <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01103"></a>01103   }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getModuleTypeIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module)<span class="keyword"> const </span>{
<a name="l01106"></a>01106 
<a name="l01107"></a>01107     <span class="keywordflow">if</span> ( ! valid(module,_moduleAvailable) ) <span class="keywordflow">throw</span> BadDataException(<span class="stringliteral">&quot;module number does not exist&quot;</span>);
<a name="l01108"></a>01108 
<a name="l01109"></a>01109     <span class="keywordflow">return</span> _typeVmodule.at(module);
<a name="l01110"></a>01110   }
<a name="l01111"></a>01111 
<a name="l01112"></a>01112   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getIndexModuleConnection(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fe)<span class="keyword"> const </span>{
<a name="l01113"></a>01113     indexMap_t::const_iterator crateIndexIter = _crateIndex.find(crate);
<a name="l01114"></a>01114     <span class="keywordflow">if</span> (crateIndexIter == _crateIndex.end()) <span class="keywordflow">throw</span> BadDataException(<span class="stringliteral">&quot;crate does not exist&quot;</span>);
<a name="l01115"></a>01115     <span class="keywordflow">return</span>
<a name="l01116"></a>01116     crateIndexIter-&gt;second*_nSlot*_nFe +
<a name="l01117"></a>01117     _slotIndex[slot]*_nFe +
<a name="l01118"></a>01118     fe;
<a name="l01119"></a>01119   }
<a name="l01120"></a>01120   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getCrateFromModuleConnectionIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01121"></a>01121     <span class="keywordflow">return</span> _crateNumber[index/(_nSlot*_nFe)];
<a name="l01122"></a>01122   }
<a name="l01123"></a>01123   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getSlotFromModuleConnectionIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01124"></a>01124     <span class="keywordflow">return</span> _slotNumber[(index%(_nSlot*_nFe))/_nFe];
<a name="l01125"></a>01125   }
<a name="l01126"></a>01126   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getFeFromModuleConnectionIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01127"></a>01127     <span class="keywordflow">return</span> index%_nFe;
<a name="l01128"></a>01128   }
<a name="l01129"></a>01129 
<a name="l01130"></a>01130   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getCompactIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan)<span class="keyword"> const </span>{
<a name="l01131"></a>01131     <span class="keywordflow">return</span> module*_nChip*_nChan + getIndexChan(chip,chan);
<a name="l01132"></a>01132   }
<a name="l01133"></a>01133   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getCompactIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chanIndex)<span class="keyword"> const </span>{
<a name="l01134"></a>01134     <span class="keywordflow">return</span> module*_nChip*_nChan + chanIndex;
<a name="l01135"></a>01135   }
<a name="l01136"></a>01136   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getModuleFromCompactIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01137"></a>01137     <span class="keywordflow">return</span> index/(_nChip*_nChan);
<a name="l01138"></a>01138   }
<a name="l01139"></a>01139   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getChipFromCompactIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01140"></a>01140     <span class="keywordflow">return</span> getChipFromChanIndex( index%(_nChip*_nChan) );
<a name="l01141"></a>01141   }
<a name="l01142"></a>01142   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getChanFromCompactIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l01143"></a>01143     <span class="keywordflow">return</span> getChanFromChanIndex( index%(_nChip*_nChan) );
<a name="l01144"></a>01144   }
<a name="l01145"></a>01145   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getModuleFromIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index, <span class="keywordtype">bool</span> &amp;valid)<span class="keyword"> const </span>{
<a name="l01146"></a>01146     <span class="keywordflow">if</span> ( index &gt; <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a628441b11caa652f1d13599675b8da6d" title="get the maximum value of the compact index for storing data in vectors">getMaxIndex</a>() ) {
<a name="l01147"></a>01147       valid = <span class="keyword">false</span>;
<a name="l01148"></a>01148       <span class="keywordflow">return</span> std::numeric_limits&lt;unsigned int&gt;::max();
<a name="l01149"></a>01149     }
<a name="l01150"></a>01150     <span class="keywordflow">else</span> {
<a name="l01151"></a>01151       valid = <span class="keyword">true</span>;
<a name="l01152"></a>01152       <span class="keywordflow">return</span> getModuleFromCompactIndex(index);
<a name="l01153"></a>01153     }
<a name="l01154"></a>01154   }
<a name="l01155"></a>01155 
<a name="l01156"></a>01156 
<a name="l01157"></a>01157   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getIndexChan(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chan)<span class="keyword"> const </span>{<span class="keywordflow">return</span> chip*_nChan+chan;}
<a name="l01158"></a>01158   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getChipFromChanIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{<span class="keywordflow">return</span> index/_nChan;}
<a name="l01159"></a>01159   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getChanFromChanIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{<span class="keywordflow">return</span> index%_nChan;}
<a name="l01160"></a>01160 
<a name="l01161"></a>01161   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getIndexIJ(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j)<span class="keyword"> const </span>{<span class="keywordflow">return</span> j*_nI+i;}
<a name="l01162"></a>01162   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getIFromIJIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{<span class="keywordflow">return</span> index%_nI;}
<a name="l01163"></a>01163   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getJFromIJIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{<span class="keywordflow">return</span> index/_nI;}
<a name="l01164"></a>01164 
<a name="l01165"></a>01165   <span class="comment">//memory managment functions</span>
<a name="l01166"></a>01166 
<a name="l01167"></a>01167   <span class="keywordtype">void</span> clearCrate() {
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     _crateIndex.clear();
<a name="l01170"></a>01170     _crateNumber.clear();
<a name="l01171"></a>01171 
<a name="l01172"></a>01172     _nCrate = 0;
<a name="l01173"></a>01173   }
<a name="l01174"></a>01174 
<a name="l01175"></a>01175 
<a name="l01176"></a>01176   <span class="keywordtype">void</span> clearSlot() {
<a name="l01177"></a>01177     _slotAvailable.clear();
<a name="l01178"></a>01178     _slotIndex.clear();
<a name="l01179"></a>01179     _slotNumber.clear();
<a name="l01180"></a>01180     _nSlot = 0;
<a name="l01181"></a>01181     _maxSlot = 0;
<a name="l01182"></a>01182   }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184   <span class="keywordtype">void</span> clearModuleType() {
<a name="l01185"></a>01185     _moduleTypeName.clear();
<a name="l01186"></a>01186     _moduleTypeIndex.clear();
<a name="l01187"></a>01187     _moduleTypeAvailable.clear();
<a name="l01188"></a>01188     _chipChanAvailable.clear();
<a name="l01189"></a>01189     _ijAvailable.clear();
<a name="l01190"></a>01190     _nModType = 0;
<a name="l01191"></a>01191   }
<a name="l01192"></a>01192 
<a name="l01193"></a>01193   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l01194"></a>01194   <span class="keywordtype">void</span> initToSize( std::vector&lt;T&gt; &amp;vec, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size, <span class="keyword">const</span> T initValue) {
<a name="l01195"></a>01195     vec.clear();
<a name="l01196"></a>01196     vec.resize(size,initValue);
<a name="l01197"></a>01197   }
<a name="l01198"></a>01198 
<a name="l01199"></a>01199   <span class="keywordtype">void</span> initToSize( std::vector&lt;bool&gt; &amp;vec, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size ) {
<a name="l01200"></a>01200     initToSize(vec,size,<span class="keyword">false</span>);
<a name="l01201"></a>01201   }
<a name="l01202"></a>01202 
<a name="l01203"></a>01203   <span class="keywordtype">void</span> initToSize( std::vector&lt;unsigned int&gt; &amp;dataVec, std::vector&lt;bool&gt; &amp;availableVec, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size) {
<a name="l01204"></a>01204     initToSize(dataVec,size,0u);
<a name="l01205"></a>01205     initToSize(availableVec,size);
<a name="l01206"></a>01206   }
<a name="l01207"></a>01207 
<a name="l01208"></a>01208   <span class="keywordtype">void</span> initFe(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxFe = 0) {
<a name="l01209"></a>01209     _nFe = maxFe+1;
<a name="l01210"></a>01210 
<a name="l01211"></a>01211     initToSize(_moduleVconnection,_connectionAvailable,_nCrate*_nSlot*_nFe);
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213 
<a name="l01214"></a>01214   <span class="keywordtype">void</span> initModule(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxMod = 0) {
<a name="l01215"></a>01215     _nMod = maxMod+1;
<a name="l01216"></a>01216 
<a name="l01217"></a>01217     initToSize(_typeVmodule,_moduleAvailable,_nMod);
<a name="l01218"></a>01218 
<a name="l01219"></a>01219     initToSize(_connectionVmodule,_connectionVmoduleAvailable,_nMod);
<a name="l01220"></a>01220 
<a name="l01221"></a>01221     initToSize(_kVmodule,_kVmoduleAvailable,_nMod);
<a name="l01222"></a>01222   }
<a name="l01223"></a>01223 
<a name="l01224"></a>01224   <span class="keywordtype">void</span> initK(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxK = 0) {
<a name="l01225"></a>01225     _nK = maxK+1;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227     initToSize(_moduleVk,_kAvailable,_nK);
<a name="l01228"></a>01228   }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230   <span class="keywordtype">void</span> initIJChipChannel( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxI =0, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxJ=0, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxChip =0, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxChan =0  ) {
<a name="l01231"></a>01231 
<a name="l01232"></a>01232     _nI = maxI+1;
<a name="l01233"></a>01233     _nJ = maxJ+1;
<a name="l01234"></a>01234     _nChip = maxChip+1;
<a name="l01235"></a>01235     _nChan = maxChan+1;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 
<a name="l01238"></a>01238     _ijVchan.clear();
<a name="l01239"></a>01239     _ijVchan.resize(_nModType);
<a name="l01240"></a>01240 
<a name="l01241"></a>01241     _chanVij.clear();
<a name="l01242"></a>01242     _chanVij.resize(_nModType);
<a name="l01243"></a>01243 
<a name="l01244"></a>01244     _sizeIVchan.clear();
<a name="l01245"></a>01245     _sizeIVchan.resize(_nModType);
<a name="l01246"></a>01246 
<a name="l01247"></a>01247     _sizeJVchan.clear();
<a name="l01248"></a>01248     _sizeJVchan.resize(_nModType);
<a name="l01249"></a>01249 
<a name="l01250"></a>01250     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> modType=0;modType&lt;_nModType;++modType) {
<a name="l01251"></a>01251 
<a name="l01252"></a>01252       initToSize( _chanVij.at(modType), _ijAvailable.at(modType), _nI*_nJ);
<a name="l01253"></a>01253       initToSize( _ijSecondaryAvailable.at(modType), _nI*_nJ);
<a name="l01254"></a>01254 
<a name="l01255"></a>01255       initToSize( _ijVchan.at(modType), _chipChanAvailable.at(modType), _nChip*_nChan);
<a name="l01256"></a>01256 
<a name="l01257"></a>01257       initToSize( _sizeIVchan.at(modType),_nChip*_nChan,(<span class="keywordtype">unsigned</span> int)0);
<a name="l01258"></a>01258       initToSize( _sizeJVchan.at(modType),_nChip*_nChan,(<span class="keywordtype">unsigned</span> int)0);
<a name="l01259"></a>01259 
<a name="l01260"></a>01260     }
<a name="l01261"></a>01261   }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 
<a name="l01264"></a>01264   <span class="keywordtype">void</span> clear() {
<a name="l01265"></a>01265 
<a name="l01266"></a>01266     clearCrate();
<a name="l01267"></a>01267 
<a name="l01268"></a>01268     clearSlot();
<a name="l01269"></a>01269 
<a name="l01270"></a>01270     clearModuleType();
<a name="l01271"></a>01271 
<a name="l01272"></a>01272     initModule();
<a name="l01273"></a>01273 
<a name="l01274"></a>01274     initFe();
<a name="l01275"></a>01275 
<a name="l01276"></a>01276     initK();
<a name="l01277"></a>01277 
<a name="l01278"></a>01278     initIJChipChannel();
<a name="l01279"></a>01279 
<a name="l01280"></a>01280   }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282   <span class="keywordtype">void</span> registerCrate(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate) {
<a name="l01283"></a>01283     <span class="keywordflow">if</span> (! crateAvailable(crate) ) {
<a name="l01284"></a>01284       _crateIndex[crate] = _crateNumber.size();
<a name="l01285"></a>01285       _crateNumber.push_back(crate);
<a name="l01286"></a>01286       _nCrate++;
<a name="l01287"></a>01287     }
<a name="l01288"></a>01288   }
<a name="l01289"></a>01289 
<a name="l01290"></a>01290   <span class="keywordtype">bool</span> crateAvailable(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate)<span class="keyword"> const </span>{
<a name="l01291"></a>01291     indexMap_t::const_iterator element = _crateIndex.find(crate);
<a name="l01292"></a>01292     <span class="keywordflow">if</span> (element == _crateIndex.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01293"></a>01293     <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01294"></a>01294   }
<a name="l01295"></a>01295 
<a name="l01296"></a>01296   <span class="keywordtype">void</span> registerSlot(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot) {
<a name="l01297"></a>01297     <span class="keywordflow">if</span> (! slotAvailable(slot) ) {
<a name="l01298"></a>01298       <span class="keywordflow">if</span> ( slot &gt;= _slotAvailable.size() ) {
<a name="l01299"></a>01299         _maxSlot = slot;
<a name="l01300"></a>01300         _slotAvailable.resize(_maxSlot+1,<span class="keyword">false</span>);
<a name="l01301"></a>01301         _slotIndex.resize(_maxSlot+1,0);
<a name="l01302"></a>01302       }
<a name="l01303"></a>01303       _slotIndex[slot] = _slotNumber.size();
<a name="l01304"></a>01304       _slotNumber.push_back(slot);
<a name="l01305"></a>01305       _slotAvailable[slot] = <span class="keyword">true</span>;
<a name="l01306"></a>01306       _nSlot = _slotNumber.size();
<a name="l01307"></a>01307     }
<a name="l01308"></a>01308   }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310   <span class="keywordtype">bool</span> slotAvailable(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot)<span class="keyword"> const </span>{
<a name="l01311"></a>01311     <span class="keywordflow">if</span> ( slot &gt;= _slotAvailable.size() ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01312"></a>01312     <span class="keywordflow">else</span> <span class="keywordflow">return</span> _slotAvailable[slot];
<a name="l01313"></a>01313   }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315   <span class="keywordtype">void</span> registerModuleType(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeName) {
<a name="l01316"></a>01316 
<a name="l01317"></a>01317     <span class="comment">//      std::cout &lt;&lt; &quot;registering module type name: &quot; &lt;&lt; moduleTypeName &lt;&lt; std::endl;</span>
<a name="l01318"></a>01318 
<a name="l01319"></a>01319     <span class="keywordflow">if</span> (! moduleTypeAvailable(moduleTypeName) ) {
<a name="l01320"></a>01320       <span class="keywordflow">if</span> (moduleTypeName &gt;= _moduleTypeAvailable.size() ) {
<a name="l01321"></a>01321         _moduleTypeAvailable.resize(moduleTypeName+1,<span class="keyword">false</span>);
<a name="l01322"></a>01322         _moduleTypeIndex.resize(moduleTypeName+1,0);
<a name="l01323"></a>01323       }
<a name="l01324"></a>01324       _moduleTypeIndex[moduleTypeName] = _moduleTypeName.size();
<a name="l01325"></a>01325       _moduleTypeName.push_back(moduleTypeName);
<a name="l01326"></a>01326       _moduleTypeAvailable[moduleTypeName] = <span class="keyword">true</span>;
<a name="l01327"></a>01327 
<a name="l01328"></a>01328       std::vector&lt;bool&gt; ijVec;
<a name="l01329"></a>01329       std::vector&lt;bool&gt; ijVecSec;
<a name="l01330"></a>01330       std::vector&lt;bool&gt; chipChanVec;
<a name="l01331"></a>01331 
<a name="l01332"></a>01332       _ijAvailable.push_back(ijVec);
<a name="l01333"></a>01333       _ijSecondaryAvailable.push_back(ijVecSec);
<a name="l01334"></a>01334       _chipChanAvailable.push_back(chipChanVec);
<a name="l01335"></a>01335 
<a name="l01336"></a>01336       _nModType=_moduleTypeName.size();
<a name="l01337"></a>01337 
<a name="l01338"></a>01338     }
<a name="l01339"></a>01339   }
<a name="l01340"></a>01340 
<a name="l01341"></a>01341   <span class="keywordtype">bool</span> moduleTypeAvailable(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeName)<span class="keyword"> const </span>{
<a name="l01342"></a>01342     <span class="keywordflow">if</span> (moduleTypeName &gt;= _moduleTypeAvailable.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01343"></a>01343     <span class="keywordflow">else</span> <span class="keywordflow">return</span> _moduleTypeAvailable[moduleTypeName];
<a name="l01344"></a>01344   }
<a name="l01345"></a>01345 
<a name="l01346"></a>01346   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> countAvailable(<span class="keyword">const</span> std::vector&lt;bool&gt; &amp;vec) <span class="keyword">const</span> ;
<a name="l01347"></a>01347 
<a name="l01348"></a>01348 
<a name="l01349"></a>01349   <span class="comment">// set functions</span>
<a name="l01350"></a>01350   <span class="keywordtype">void</span> setModuleCrateSlotFe(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crate, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> slot, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fe) {
<a name="l01351"></a>01351 
<a name="l01352"></a>01352     <span class="keywordflow">if</span> ( ! _connectionVmoduleAvailable.at(module)  &amp;&amp; ! _connectionAvailable.at(getIndexModuleConnection(crate, slot, fe)) ) {
<a name="l01353"></a>01353       _moduleVconnection.at(getIndexModuleConnection(crate, slot, fe)) = module;
<a name="l01354"></a>01354       _connectionVmodule.at(module) = getIndexModuleConnection(crate, slot, fe);
<a name="l01355"></a>01355       _connectionVmoduleAvailable.at(module) = <span class="keyword">true</span>;
<a name="l01356"></a>01356       _connectionAvailable.at(getIndexModuleConnection(crate, slot, fe)) = <span class="keyword">true</span>;
<a name="l01357"></a>01357     }
<a name="l01358"></a>01358     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (    _connectionVmoduleAvailable.at(module) &amp;&amp; _connectionAvailable.at(getIndexModuleConnection(crate, slot, fe))
<a name="l01359"></a>01359     &amp;&amp; ( _moduleVconnection.at(getIndexModuleConnection(crate, slot, fe)) == module )
<a name="l01360"></a>01360     &amp;&amp; ( _connectionVmodule.at(module) == getIndexModuleConnection(crate, slot, fe) ) ) {
<a name="l01361"></a>01361       std::cout  &lt;&lt; <span class="stringliteral">&quot;WARNING: double setting of module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; connected to crate &quot;</span> &lt;&lt; crate &lt;&lt; <span class="stringliteral">&quot; slot &quot;</span> &lt;&lt; slot &lt;&lt; <span class="stringliteral">&quot; FE &quot;</span> &lt;&lt; fe &lt;&lt; std::endl;
<a name="l01362"></a>01362     }
<a name="l01363"></a>01363     <span class="keywordflow">else</span> {
<a name="l01364"></a>01364       std::cout &lt;&lt; <span class="stringliteral">&quot;ERROR: setting of module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; connected to crate &quot;</span> &lt;&lt; crate &lt;&lt; <span class="stringliteral">&quot; slot &quot;</span> &lt;&lt; slot &lt;&lt; <span class="stringliteral">&quot; FE &quot;</span> &lt;&lt; fe &lt;&lt; std::endl;
<a name="l01365"></a>01365       std::cout &lt;&lt; <span class="stringliteral">&quot;       is in conflict with: &quot;</span> &lt;&lt; std::endl;
<a name="l01366"></a>01366       <span class="keywordflow">if</span> ( _connectionVmoduleAvailable.at(module) ) {
<a name="l01367"></a>01367         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> connectionIndex = _connectionVmodule.at(module);
<a name="l01368"></a>01368         std::cout  &lt;&lt; <span class="stringliteral">&quot;setting of module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; connected to crate &quot;</span> &lt;&lt; getCrateFromModuleConnectionIndex(connectionIndex) &lt;&lt; <span class="stringliteral">&quot; slot &quot;</span> &lt;&lt; getSlotFromModuleConnectionIndex(connectionIndex) &lt;&lt; <span class="stringliteral">&quot; FE &quot;</span> &lt;&lt; getFeFromModuleConnectionIndex(connectionIndex) &lt;&lt; std::endl;
<a name="l01369"></a>01369       }
<a name="l01370"></a>01370       <span class="keywordflow">if</span> ( _connectionAvailable.at(getIndexModuleConnection(crate,slot, fe)) ) {
<a name="l01371"></a>01371         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> existingModule = _moduleVconnection.at(getIndexModuleConnection(crate,slot, fe));
<a name="l01372"></a>01372         std::cout  &lt;&lt; <span class="stringliteral">&quot;setting of module &quot;</span> &lt;&lt; existingModule &lt;&lt; <span class="stringliteral">&quot; connected to crate &quot;</span> &lt;&lt; crate &lt;&lt; <span class="stringliteral">&quot; slot &quot;</span> &lt;&lt; slot &lt;&lt; <span class="stringliteral">&quot; FE &quot;</span> &lt;&lt; fe &lt;&lt; std::endl;
<a name="l01373"></a>01373       }
<a name="l01374"></a>01374     }
<a name="l01375"></a>01375   }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377   <span class="keywordtype">void</span> setModuleType(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> typeName) {
<a name="l01378"></a>01378     <span class="keywordflow">if</span> ( ! _moduleAvailable.at(module) ) {
<a name="l01379"></a>01379       _typeVmodule.at(module) = _moduleTypeIndex.at(typeName);
<a name="l01380"></a>01380       _moduleAvailable.at(module) = <span class="keyword">true</span>;
<a name="l01381"></a>01381     }
<a name="l01382"></a>01382     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( _moduleAvailable.at(module) &amp;&amp; ( _typeVmodule.at(module) == _moduleTypeIndex.at(typeName) ) ) {
<a name="l01383"></a>01383       std::cout  &lt;&lt; <span class="stringliteral">&quot;WARNING: double setting of module type name &quot;</span> &lt;&lt; typeName &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; module &lt;&lt; std::endl;
<a name="l01384"></a>01384     }
<a name="l01385"></a>01385     <span class="keywordflow">else</span> {
<a name="l01386"></a>01386       std::cout  &lt;&lt; <span class="stringliteral">&quot;ERROR: setting of module type name &quot;</span> &lt;&lt; typeName &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; module &lt;&lt; std::endl
<a name="l01387"></a>01387       &lt;&lt; <span class="stringliteral">&quot;       conflicts with previous setting of type name&quot;</span> &lt;&lt; _moduleTypeName.at(_typeVmodule.at(module)) &lt;&lt; std::endl;
<a name="l01388"></a>01388     }
<a name="l01389"></a>01389 
<a name="l01390"></a>01390   }
<a name="l01391"></a>01391 
<a name="l01392"></a>01392 
<a name="l01393"></a>01393   <span class="keywordtype">void</span> setModuleK(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> module, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> K) {
<a name="l01394"></a>01394     <span class="keywordflow">if</span> ( ! _kVmoduleAvailable.at(module) &amp;&amp; ! _kAvailable.at(K) ) {
<a name="l01395"></a>01395 
<a name="l01396"></a>01396       _kVmodule.at(module) = K;
<a name="l01397"></a>01397       _kVmoduleAvailable.at(module) = <span class="keyword">true</span>;
<a name="l01398"></a>01398 
<a name="l01399"></a>01399       _moduleVk.at(K) = module;
<a name="l01400"></a>01400       _kAvailable.at(K) = <span class="keyword">true</span>;
<a name="l01401"></a>01401 
<a name="l01402"></a>01402     }
<a name="l01403"></a>01403     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (    _kVmoduleAvailable.at(module) &amp;&amp; _kAvailable.at(K)
<a name="l01404"></a>01404     &amp;&amp; _kVmodule.at(module) == K     &amp;&amp; _moduleVk.at(K) == module ) {
<a name="l01405"></a>01405       std::cout  &lt;&lt; <span class="stringliteral">&quot;WARNING: double setting of module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; and K &quot;</span> &lt;&lt; K &lt;&lt; std::endl;
<a name="l01406"></a>01406     }
<a name="l01407"></a>01407     <span class="keywordflow">else</span> {
<a name="l01408"></a>01408       std::cout  &lt;&lt; <span class="stringliteral">&quot;ERROR: setting of module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; and K &quot;</span> &lt;&lt; K &lt;&lt; std::endl
<a name="l01409"></a>01409       &lt;&lt; <span class="stringliteral">&quot;       conflicts with: &quot;</span> &lt;&lt; std::endl;
<a name="l01410"></a>01410       <span class="keywordflow">if</span> ( _kAvailable.at(K) ) std::cout &lt;&lt; <span class="stringliteral">&quot;           module &quot;</span> &lt;&lt; _moduleVk.at(K) &lt;&lt; <span class="stringliteral">&quot; K &quot;</span> &lt;&lt; K &lt;&lt;  std::endl;
<a name="l01411"></a>01411       <span class="keywordflow">if</span> ( _kVmoduleAvailable.at(module) ) std::cout &lt;&lt; <span class="stringliteral">&quot;           module &quot;</span> &lt;&lt; module &lt;&lt; <span class="stringliteral">&quot; K &quot;</span> &lt;&lt; _kVmodule.at(module) &lt;&lt; std::endl;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413     }
<a name="l01414"></a>01414   }
<a name="l01415"></a>01415 
<a name="l01416"></a>01416   <span class="keywordtype">void</span> setModuleTypeIJChipChannel(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleTypeName, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> I, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> J, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeI, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeJ, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chip, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> channel) {
<a name="l01417"></a>01417     <span class="comment">//      std::cout &lt;&lt; &quot;setting moduleTyp &quot; &lt;&lt; moduleType &lt;&lt; &quot; I &quot; &lt;&lt; I &lt;&lt; &quot; J &quot; &lt;&lt; J &lt;&lt; &quot; sizeI &quot; &lt;&lt; sizeI &lt;&lt; &quot; sizeJ &quot; &lt;&lt; sizeJ &lt;&lt; &quot; chip &quot; &lt;&lt; chip &lt;&lt; &quot; chan &quot; &lt;&lt; channel &lt;&lt; std::endl;</span>
<a name="l01418"></a>01418 
<a name="l01419"></a>01419     <span class="keywordflow">if</span> (! moduleTypeAvailable(moduleTypeName))
<a name="l01420"></a>01420     <span class="keywordflow">throw</span> BadDataException(<span class="stringliteral">&quot;setModuleTypeIJChipChannel: moduleTypeName is unknown&quot;</span>);
<a name="l01421"></a>01421 
<a name="l01422"></a>01422     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleType = _moduleTypeIndex.at(moduleTypeName);
<a name="l01423"></a>01423 
<a name="l01424"></a>01424     <span class="keywordflow">if</span> (    ! _chipChanAvailable.at(moduleType).at(getIndexChan(chip,channel))
<a name="l01425"></a>01425     &amp;&amp; ! _ijAvailable.at(moduleType).at(getIndexIJ(I,J)) ) {
<a name="l01426"></a>01426 
<a name="l01427"></a>01427       _ijVchan.at(moduleType).at(getIndexChan(chip,channel)) = getIndexIJ(I,J);
<a name="l01428"></a>01428       _chipChanAvailable.at(moduleType).at(getIndexChan(chip,channel)) = <span class="keyword">true</span>;
<a name="l01429"></a>01429 
<a name="l01430"></a>01430       _chanVij.at(moduleType).at(getIndexIJ(I,J)) = getIndexChan(chip,channel);
<a name="l01431"></a>01431       _ijAvailable.at(moduleType).at(getIndexIJ(I,J)) = <span class="keyword">true</span>;
<a name="l01432"></a>01432 
<a name="l01433"></a>01433       _sizeIVchan.at(moduleType).at(getIndexChan(chip,channel)) = sizeI;
<a name="l01434"></a>01434       _sizeJVchan.at(moduleType).at(getIndexChan(chip,channel)) = sizeJ;
<a name="l01435"></a>01435       <span class="comment">/*</span>
<a name="l01436"></a>01436 <span class="comment">      for (unsigned int i=I;i&lt;I+sizeI;++i)</span>
<a name="l01437"></a>01437 <span class="comment">      for (unsigned int j=J;j&lt;J+sizeJ;++j)</span>
<a name="l01438"></a>01438 <span class="comment">      if (!(i==I &amp;&amp; j==J) ) {</span>
<a name="l01439"></a>01439 <span class="comment">      if (_ijAvailable.at(moduleType).at(getIndexIJ(i,j)) || _ijSecondaryAvailable.at(moduleType).at(getIndexIJ(i,j))) {</span>
<a name="l01440"></a>01440 <span class="comment">      unsigned int chanindex = _chanVij.at(moduleType).at(getIndexIJ(i,j));</span>
<a name="l01441"></a>01441 <span class="comment"></span>
<a name="l01442"></a>01442 <span class="comment">      std::cout  &lt;&lt; &quot;ERROR: setting of moduleTyp &quot; &lt;&lt; moduleTypeName &lt;&lt; &quot; I &quot; &lt;&lt; I &lt;&lt; &quot; J &quot; &lt;&lt; J &lt;&lt; &quot; sizeI &quot; &lt;&lt; sizeI &lt;&lt; &quot; sizeJ &quot; &lt;&lt; sizeJ &lt;&lt; &quot; chip &quot; &lt;&lt; chip &lt;&lt; &quot; chan &quot; &lt;&lt; channel &lt;&lt; std::endl</span>
<a name="l01443"></a>01443 <span class="comment">      &lt;&lt; &quot;       overlaps with:&quot;</span>
<a name="l01444"></a>01444 <span class="comment">      &lt;&lt; &quot; I &quot; &lt;&lt; getIFromIJIndex(_ijVchan.at(moduleType).at(chanindex))</span>
<a name="l01445"></a>01445 <span class="comment">      &lt;&lt; &quot; J &quot; &lt;&lt; getJFromIJIndex(_ijVchan.at(moduleType).at(chanindex))</span>
<a name="l01446"></a>01446 <span class="comment">      &lt;&lt; &quot; sizeI &quot; &lt;&lt; _sizeIVchan.at(moduleType).at(chanindex)</span>
<a name="l01447"></a>01447 <span class="comment">      &lt;&lt; &quot; sizeJ &quot; &lt;&lt; _sizeIVchan.at(moduleType).at(chanindex)</span>
<a name="l01448"></a>01448 <span class="comment">      &lt;&lt; &quot; chip &quot; &lt;&lt; getChipFromChanIndex(chanindex) &lt;&lt; &quot; chan &quot; &lt;&lt; getChanFromChanIndex(chanindex) &lt;&lt; std::endl</span>
<a name="l01449"></a>01449 <span class="comment">      &lt;&lt; &quot; at I &quot; &lt;&lt; i &lt;&lt; &quot; J &quot; &lt;&lt; j &lt;&lt; std::endl;</span>
<a name="l01450"></a>01450 <span class="comment"></span>
<a name="l01451"></a>01451 <span class="comment">    }</span>
<a name="l01452"></a>01452 <span class="comment"></span>
<a name="l01453"></a>01453 <span class="comment">    _chanVij.at(moduleType).at(getIndexIJ(i,j)) = getIndexChan(chip,channel);</span>
<a name="l01454"></a>01454 <span class="comment">    _ijSecondaryAvailable.at(moduleType).at(getIndexIJ(i,j)) = true;</span>
<a name="l01455"></a>01455 <span class="comment">  }</span>
<a name="l01456"></a>01456 <span class="comment">  */</span>
<a name="l01457"></a>01457 
<a name="l01458"></a>01458   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=I;
<a name="l01459"></a>01459   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=J;
<a name="l01460"></a>01460   <span class="keywordflow">if</span> (i==I &amp;&amp; j==J) {
<a name="l01461"></a>01461     <span class="keywordflow">if</span> (_ijAvailable.at(moduleType).at(getIndexIJ(i,j)) || _ijSecondaryAvailable.at(moduleType).at(getIndexIJ(i,j))) {
<a name="l01462"></a>01462 
<a name="l01463"></a>01463       <span class="comment">/*</span>
<a name="l01464"></a>01464 <span class="comment">      unsigned int chanindex = _chanVij.at(moduleType).at(getIndexIJ(i,j));</span>
<a name="l01465"></a>01465 <span class="comment">      std::cout  &lt;&lt; &quot;Setting of moduleTyp &quot; &lt;&lt; moduleTypeName &lt;&lt; &quot; I &quot; &lt;&lt; I &lt;&lt; &quot; J &quot; &lt;&lt; J &lt;&lt; &quot; sizeI &quot; &lt;&lt; sizeI &lt;&lt; &quot; sizeJ &quot; &lt;&lt; sizeJ &lt;&lt; &quot; chip &quot; &lt;&lt; chip &lt;&lt; &quot; chan &quot; &lt;&lt; channel &lt;&lt; std::endl</span>
<a name="l01466"></a>01466 <span class="comment">      &lt;&lt; &quot;         Check with:  &quot;</span>
<a name="l01467"></a>01467 <span class="comment">      &lt;&lt; &quot; I &quot; &lt;&lt; getIFromIJIndex(_ijVchan.at(moduleType).at(chanindex))</span>
<a name="l01468"></a>01468 <span class="comment">      &lt;&lt; &quot; J &quot; &lt;&lt; getJFromIJIndex(_ijVchan.at(moduleType).at(chanindex))</span>
<a name="l01469"></a>01469 <span class="comment">      &lt;&lt; &quot; sizeI &quot; &lt;&lt; _sizeIVchan.at(moduleType).at(chanindex)</span>
<a name="l01470"></a>01470 <span class="comment">      &lt;&lt; &quot; sizeJ &quot; &lt;&lt; _sizeIVchan.at(moduleType).at(chanindex)</span>
<a name="l01471"></a>01471 <span class="comment">      &lt;&lt; &quot; chip &quot; &lt;&lt; getChipFromChanIndex(chanindex) &lt;&lt; &quot; chan &quot; &lt;&lt; getChanFromChanIndex(chanindex) &lt;&lt; std::endl</span>
<a name="l01472"></a>01472 <span class="comment">      &lt;&lt; std::endl;</span>
<a name="l01473"></a>01473 <span class="comment">      */</span>
<a name="l01474"></a>01474     }
<a name="l01475"></a>01475 
<a name="l01476"></a>01476     _chanVij.at(moduleType).at(getIndexIJ(i,j)) = getIndexChan(chip,channel);
<a name="l01477"></a>01477     _ijSecondaryAvailable.at(moduleType).at(getIndexIJ(i,j)) = <span class="keyword">true</span>;
<a name="l01478"></a>01478   }
<a name="l01479"></a>01479 
<a name="l01480"></a>01480 
<a name="l01481"></a>01481 }
<a name="l01482"></a>01482 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (    _chipChanAvailable.at(moduleType).at(getIndexChan(chip,channel))
<a name="l01483"></a>01483 &amp;&amp; _ijAvailable.at(moduleType).at(getIndexIJ(I,J))
<a name="l01484"></a>01484 &amp;&amp; ( _ijVchan.at(moduleType).at(getIndexChan(chip,channel)) == getIndexIJ(I,J) )
<a name="l01485"></a>01485 &amp;&amp; ( _chanVij.at(moduleType).at(getIndexIJ(I,J)) == getIndexChan(chip,channel) )
<a name="l01486"></a>01486 &amp;&amp; ( _sizeIVchan.at(moduleType).at(getIndexChan(chip,channel)) == sizeI )
<a name="l01487"></a>01487 &amp;&amp; ( _sizeJVchan.at(moduleType).at(getIndexChan(chip,channel)) == sizeJ ) ) {
<a name="l01488"></a>01488 
<a name="l01489"></a>01489   std::cout  &lt;&lt; <span class="stringliteral">&quot;WARNING: double setting of moduleTyp &quot;</span> &lt;&lt; moduleTypeName &lt;&lt; <span class="stringliteral">&quot; I &quot;</span> &lt;&lt; I &lt;&lt; <span class="stringliteral">&quot; J &quot;</span> &lt;&lt; J &lt;&lt; <span class="stringliteral">&quot; sizeI &quot;</span> &lt;&lt; sizeI &lt;&lt; <span class="stringliteral">&quot; sizeJ &quot;</span> &lt;&lt; sizeJ &lt;&lt; <span class="stringliteral">&quot; chip &quot;</span> &lt;&lt; chip &lt;&lt; <span class="stringliteral">&quot; chan &quot;</span> &lt;&lt; channel &lt;&lt; std::endl;
<a name="l01490"></a>01490 }
<a name="l01491"></a>01491 <span class="keywordflow">else</span> {
<a name="l01492"></a>01492   std::cout  &lt;&lt; <span class="stringliteral">&quot;ERROR: setting of moduleTyp &quot;</span> &lt;&lt; moduleTypeName &lt;&lt; <span class="stringliteral">&quot; I &quot;</span> &lt;&lt; I &lt;&lt; <span class="stringliteral">&quot; J &quot;</span> &lt;&lt; J &lt;&lt; <span class="stringliteral">&quot; sizeI &quot;</span> &lt;&lt; sizeI &lt;&lt; <span class="stringliteral">&quot; sizeJ &quot;</span> &lt;&lt; sizeJ &lt;&lt; <span class="stringliteral">&quot; chip &quot;</span> &lt;&lt; chip &lt;&lt; <span class="stringliteral">&quot; chan &quot;</span> &lt;&lt; channel &lt;&lt; std::endl
<a name="l01493"></a>01493   &lt;&lt; <span class="stringliteral">&quot;       is in conflict with &quot;</span> &lt;&lt; std::endl;
<a name="l01494"></a>01494   <span class="keywordflow">if</span> (_chipChanAvailable.at(moduleType).at(getIndexChan(chip,channel))) {
<a name="l01495"></a>01495     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ijindex = _ijVchan.at(moduleType).at(getIndexChan(chip,channel));
<a name="l01496"></a>01496     std::cout &lt;&lt; <span class="stringliteral">&quot;moduleType &quot;</span> &lt;&lt; moduleTypeName &lt;&lt; <span class="stringliteral">&quot; I &quot;</span> &lt;&lt; getIFromIJIndex(ijindex) &lt;&lt; <span class="stringliteral">&quot; J &quot;</span> &lt;&lt; getJFromIJIndex(ijindex) &lt;&lt; <span class="stringliteral">&quot; sizeI &quot;</span> &lt;&lt; _sizeIVchan.at(moduleType).at(getIndexChan(chip,channel)) &lt;&lt; <span class="stringliteral">&quot; sizeJ &quot;</span> &lt;&lt; _sizeJVchan.at(moduleType).at(getIndexChan(chip,channel)) &lt;&lt; <span class="stringliteral">&quot; chip &quot;</span> &lt;&lt; chip &lt;&lt; <span class="stringliteral">&quot; chan &quot;</span> &lt;&lt; channel &lt;&lt; std::endl;
<a name="l01497"></a>01497   }
<a name="l01498"></a>01498   <span class="keywordflow">if</span> (_ijAvailable.at(moduleType).at(getIndexIJ(I,J))) {
<a name="l01499"></a>01499     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chanindex = _chanVij.at(moduleType).at(getIndexIJ(I,J));
<a name="l01500"></a>01500     std::cout &lt;&lt; <span class="stringliteral">&quot;moduleType &quot;</span> &lt;&lt; moduleTypeName &lt;&lt; <span class="stringliteral">&quot; I &quot;</span> &lt;&lt; I &lt;&lt; <span class="stringliteral">&quot; J &quot;</span> &lt;&lt; J  &lt;&lt; <span class="stringliteral">&quot; sizeI &quot;</span> &lt;&lt; _sizeIVchan.at(moduleType).at(chanindex) &lt;&lt; <span class="stringliteral">&quot; sizeJ &quot;</span> &lt;&lt; _sizeJVchan.at(moduleType).at(chanindex) &lt;&lt; <span class="stringliteral">&quot; chip &quot;</span> &lt;&lt; getChipFromChanIndex(chanindex) &lt;&lt; <span class="stringliteral">&quot; chip &quot;</span> &lt;&lt; getChanFromChanIndex(chanindex) &lt;&lt; std::endl;
<a name="l01501"></a>01501   }
<a name="l01502"></a>01502 }
<a name="l01503"></a>01503 }
<a name="l01504"></a>01504 
<a name="l01505"></a>01505 <span class="comment">//fill functions</span>
<a name="l01506"></a>01506 
<a name="l01514"></a>01514 <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a24e7b07d1fbac2bc225a1af08fa52d38" title="sets the mapping information in the class, call after fillModuleDescription">fillModuleConnection</a>(<span class="keyword">const</span> lcio::LCCollection* col);
<a name="l01524"></a>01524 <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1Ahc2Mapper.html#a72a2159c191b2413a13408c2f9c24480" title="sets the module layout information in the class, module connection information will...">fillModuleDescription</a>(<span class="keyword">const</span> lcio::LCCollection* col);
<a name="l01525"></a>01525 
<a name="l01526"></a>01526 
<a name="l01527"></a>01527 <span class="comment">// helper functions</span>
<a name="l01528"></a>01528 <span class="keywordtype">void</span> getChipChannelForModuleDescriptionID(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleType, <span class="keywordtype">int</span> &amp;I, <span class="keywordtype">int</span> &amp;J) <span class="keyword">const</span> ;
<a name="l01529"></a>01529 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getCombinedModuleType(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleType) <span class="keyword">const</span> ;
<a name="l01530"></a>01530 <span class="keywordtype">int</span> correctCellIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> moduleType, <span class="keyword">const</span> <span class="keywordtype">int</span> cellIndex) <span class="keyword">const</span>;
<a name="l01531"></a>01531 <span class="keyword">const</span> std::string printIfAvailable(<span class="keywordtype">bool</span> available, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> value) <span class="keyword">const</span>;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533 <span class="comment">//private variables</span>
<a name="l01534"></a>01534 
<a name="l01535"></a>01535 
<a name="l01536"></a>01536 indexMap_t                _crateIndex;
<a name="l01537"></a>01537 std::vector&lt;unsigned int&gt; _crateNumber;
<a name="l01538"></a>01538 
<a name="l01539"></a>01539 std::vector&lt;unsigned int&gt; _slotIndex;
<a name="l01540"></a>01540 std::vector&lt;unsigned int&gt; _slotNumber;
<a name="l01541"></a>01541 std::vector&lt;bool&gt;         _slotAvailable;
<a name="l01542"></a>01542 
<a name="l01543"></a>01543 std::vector&lt;bool&gt;         _connectionAvailable;
<a name="l01544"></a>01544 
<a name="l01545"></a>01545 std::vector&lt;bool&gt;         _moduleAvailable;
<a name="l01546"></a>01546 
<a name="l01547"></a>01547 std::vector&lt;unsigned int&gt; _typeVmodule;
<a name="l01548"></a>01548 
<a name="l01549"></a>01549 std::vector&lt;unsigned int&gt; _connectionVmodule;
<a name="l01550"></a>01550 std::vector&lt;bool&gt;         _connectionVmoduleAvailable;
<a name="l01551"></a>01551 std::vector&lt;unsigned int&gt; _moduleVconnection;
<a name="l01552"></a>01552 
<a name="l01553"></a>01553 std::vector&lt;unsigned int&gt; _kVmodule;
<a name="l01554"></a>01554 std::vector&lt;bool&gt;         _kVmoduleAvailable;
<a name="l01555"></a>01555 
<a name="l01556"></a>01556 std::vector&lt;unsigned int&gt; _moduleVk;
<a name="l01557"></a>01557 std::vector&lt;bool&gt;         _kAvailable;
<a name="l01558"></a>01558 
<a name="l01559"></a>01559 
<a name="l01560"></a>01560 
<a name="l01561"></a>01561 
<a name="l01562"></a>01562 
<a name="l01563"></a>01563 std::vector&lt;unsigned int&gt;               _moduleTypeName;
<a name="l01564"></a>01564 std::vector&lt;unsigned int&gt;               _moduleTypeIndex;
<a name="l01565"></a>01565 std::vector&lt;bool        &gt;               _moduleTypeAvailable;
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 std::vector&lt;std::vector&lt;unsigned int&gt; &gt; _ijVchan;
<a name="l01568"></a>01568 std::vector&lt;std::vector&lt;bool&gt; &gt;         _chipChanAvailable;
<a name="l01569"></a>01569 
<a name="l01570"></a>01570 std::vector&lt;std::vector&lt;unsigned int&gt; &gt; _chanVij;
<a name="l01571"></a>01571 std::vector&lt;std::vector&lt;bool&gt; &gt;         _ijAvailable;
<a name="l01572"></a>01572 std::vector&lt;std::vector&lt;bool&gt; &gt;         _ijSecondaryAvailable;
<a name="l01573"></a>01573 
<a name="l01574"></a>01574 std::vector&lt;std::vector&lt;unsigned int&gt; &gt; _sizeIVchan;
<a name="l01575"></a>01575 std::vector&lt;std::vector&lt;unsigned int&gt; &gt; _sizeJVchan;
<a name="l01576"></a>01576 
<a name="l01577"></a>01577 
<a name="l01578"></a>01578 
<a name="l01579"></a>01579 };
<a name="l01580"></a>01580 }
<a name="l01581"></a>01581 
<a name="l01582"></a>01582 
<a name="l01583"></a>01583 
<a name="l01584"></a>01584 
<a name="l01585"></a>01585 
<a name="l01586"></a>01586 <span class="preprocessor">#endif //Ahc2Mapper_hh</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Dec 2017 for CALICE_USERLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
