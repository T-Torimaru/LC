<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RECOSIPM: CALICE::SiPMCalibrateProcessor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>CALICE</b>::<a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html">SiPMCalibrateProcessor</a>
  </div>
</div>
<div class="contents">
<h1>CALICE::SiPMCalibrateProcessor Class Reference</h1><!-- doxytag: class="CALICE::SiPMCalibrateProcessor" -->
<p>Processor that does the SiPM calibration.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SiPMCalibrateProcessor_8hh_source.html">SiPMCalibrateProcessor.hh</a>&gt;</code></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afcf5d46a36704ca28d4b396e3c6c880c"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::newProcessor" ref="afcf5d46a36704ca28d4b396e3c6c880c" args="()" -->
<a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html">SiPMCalibrateProcessor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#afcf5d46a36704ca28d4b396e3c6c880c">newProcessor</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a new instance of this processor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3bb0d0e2676910428b75c7b8b80ec87a"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::SiPMCalibrateProcessor" ref="a3bb0d0e2676910428b75c7b8b80ec87a" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a3bb0d0e2676910428b75c7b8b80ec87a">SiPMCalibrateProcessor</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a428372dc991fcf2593166951c3f0365c"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::~SiPMCalibrateProcessor" ref="a428372dc991fcf2593166951c3f0365c" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a428372dc991fcf2593166951c3f0365c">~SiPMCalibrateProcessor</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab2cba3af1a694e91a0574ffe20275c7"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::init" ref="aab2cba3af1a694e91a0574ffe20275c7" args="()" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#aab2cba3af1a694e91a0574ffe20275c7">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise variables, if needed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae71fa4bb6335fbb7ee61ab5d8754e152">processEvent</a> (LCEvent *evt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process event (the working horse).  <a href="#ae71fa4bb6335fbb7ee61ab5d8754e152"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a29f890dd2812216940bc4e4a1534da3d"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::end" ref="a29f890dd2812216940bc4e4a1534da3d" args="()" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a29f890dd2812216940bc4e4a1534da3d">end</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function called after all events have been processed, for cleanup. <br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a21e550aa165c9a32c585642c91f5b436">calibrateEnergyAndFillOutputCollections</a> (SiPMCalibrations *calibration, const float rawEnergy, LCCollection *ahcHitOutputCol, LCCollection *ahcAmplOutputCol, LCRelationNavigator &amp;relationNavigator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrate the energy (convert from energy in ADC counts to energy in MIPs).  <a href="#a21e550aa165c9a32c585642c91f5b436"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0cab17864ce6d8d19c045a2f29d3f385"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::checkHitAmplRelation" ref="a0cab17864ce6d8d19c045a2f29d3f385" args="(LCEvent *evt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>checkHitAmplRelation</b> (LCEvent *evt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaac485a2a610b1a3170f3ae697df5e66"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::createSimRecRelation" ref="aaac485a2a610b1a3170f3ae697df5e66" args="(LCEvent *evt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>createSimRecRelation</b> (LCEvent *evt)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57a43fb9e621a67f048f8d7e3eb422fc"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_inputColName" ref="a57a43fb9e621a67f048f8d7e3eb422fc" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a57a43fb9e621a67f048f8d7e3eb422fc">_inputColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the input collection <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab19ab03aed4e1d2c55517553b01a7bf"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_ahcHitOutputColName" ref="aab19ab03aed4e1d2c55517553b01a7bf" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#aab19ab03aed4e1d2c55517553b01a7bf">_ahcHitOutputColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the output AHC hit collection <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab050d98ccbef256701d52f6bcdbe7360"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_ahcAmplOutputColName" ref="ab050d98ccbef256701d52f6bcdbe7360" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab050d98ccbef256701d52f6bcdbe7360">_ahcAmplOutputColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the output AHC amplitude collection <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a48052d44b45a93f7d1e247e844f311b6"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_hitAmplRelationColName" ref="a48052d44b45a93f7d1e247e844f311b6" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a48052d44b45a93f7d1e247e844f311b6">_hitAmplRelationColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the LCRelation collection between CalorimeterHit and AhcAmplitude <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17f68ea31684ff76170b3878eefb1558"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_mappingProcessorName" ref="a17f68ea31684ff76170b3878eefb1558" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a17f68ea31684ff76170b3878eefb1558">_mappingProcessorName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the processor which provides the mapping <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b8de01a32b442f302706d5678b0bed7"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_calibProcessorName" ref="a0b8de01a32b442f302706d5678b0bed7" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0b8de01a32b442f302706d5678b0bed7">_calibProcessorName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the processor which provides the SiPM calibrations <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad57628decfdca245ff0bc4466e398d2f"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_temperatureProcessorName" ref="ad57628decfdca245ff0bc4466e398d2f" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad57628decfdca245ff0bc4466e398d2f">_temperatureProcessorName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the processor which provides the SiPM temperature <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7470eb03aa80ec18c2bcb3bff172411d"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_cellDescriptionProcessorName" ref="a7470eb03aa80ec18c2bcb3bff172411d" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a7470eb03aa80ec18c2bcb3bff172411d">_cellDescriptionProcessorName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the processor which provides the cells description <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a008a04e60e994e7f5a60e4752808d4cf"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_cellDescriptions" ref="a008a04e60e994e7f5a60e4752808d4cf" args="" -->
MappedContainer<br class="typebreak"/>
&lt; CellDescription &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a008a04e60e994e7f5a60e4752808d4cf">_cellDescriptions</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mapped container of cells description <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2d1cc15e62943ab55fe09f85a035e0a8"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_scaleEnergy" ref="a2d1cc15e62943ab55fe09f85a035e0a8" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2d1cc15e62943ab55fe09f85a035e0a8">_scaleEnergy</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the scaling of the hits energy <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1bb566afa9919856a28d3e0496d67236"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_energyScaleFactor" ref="a1bb566afa9919856a28d3e0496d67236" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1bb566afa9919856a28d3e0496d67236">_energyScaleFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">factor to scale the hits energy <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3901432aa67fe2cc8045eb1e33f77c18"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_createSimRecRelation" ref="a3901432aa67fe2cc8045eb1e33f77c18" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a3901432aa67fe2cc8045eb1e33f77c18">_createSimRecRelation</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to disable/enable the creation of an LCRelation between the Mokka SimCalorimeterHits and the reconstructed CalorimeterHits <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad95f8f4f5a8053e41cd19f10869f6308"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_recoContainer" ref="ad95f8f4f5a8053e41cd19f10869f6308" args="" -->
MappedContainer<br class="typebreak"/>
&lt; CalorimeterHitImpl &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad95f8f4f5a8053e41cd19f10869f6308">_recoContainer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mapped container of reconstructed AHCAL hits <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace988b5155d638e3a813a7b2a72bbe96"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_simHitColName" ref="ace988b5155d638e3a813a7b2a72bbe96" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ace988b5155d638e3a813a7b2a72bbe96">_simHitColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of collection containing SimCalorimeterHits <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a919e77aed15f7167dbdc8636341b26ad"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_simRecRelationColName" ref="a919e77aed15f7167dbdc8636341b26ad" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a919e77aed15f7167dbdc8636341b26ad">_simRecRelationColName</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">name of the relation between Mokka SimCalorimeterHits and reconstructed CalorimeterHits <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a02bb58794a7bfaade36b8ea48174a4b1"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_mapper" ref="a02bb58794a7bfaade36b8ea48174a4b1" args="" -->
const Mapper *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a02bb58794a7bfaade36b8ea48174a4b1">_mapper</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the mapper <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40e1e74a8da4c3033f4781f466c447fd"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_calibContainer" ref="a40e1e74a8da4c3033f4781f466c447fd" args="" -->
MappedContainer<br class="typebreak"/>
&lt; SiPMCalibrations &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a40e1e74a8da4c3033f4781f466c447fd">_calibContainer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mapped container of SiPM calibrations <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b48a88d42d7f14a0f70b820765b5ade"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_temperatureContainer" ref="a1b48a88d42d7f14a0f70b820765b5ade" args="" -->
MappedContainer&lt; SimpleValue &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1b48a88d42d7f14a0f70b820765b5ade">_temperatureContainer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mapped container of cells temperature <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62cbf93050afc1ee6e5c7f82fd1f3e66"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_pedestalSubtraction" ref="a62cbf93050afc1ee6e5c7f82fd1f3e66" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a62cbf93050afc1ee6e5c7f82fd1f3e66">_pedestalSubtraction</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable pedestal subtraction <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae71be6f56269b829919d429f1a85e3f8"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_doMipTempCorr" ref="ae71be6f56269b829919d429f1a85e3f8" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae71be6f56269b829919d429f1a85e3f8">_doMipTempCorr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the temperature correction of the MIP <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2228aa6db6d857d46ce8309bfa4e7026"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_doGainTempCorr" ref="a2228aa6db6d857d46ce8309bfa4e7026" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2228aa6db6d857d46ce8309bfa4e7026">_doGainTempCorr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the temperature correction of the gain <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adda23df94c9acdcc5374d17bb956dfcc"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_doSaturationCorr" ref="adda23df94c9acdcc5374d17bb956dfcc" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#adda23df94c9acdcc5374d17bb956dfcc">_doSaturationCorr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the saturation correction <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c5afe234b4e0f55c2da524153dbd2ff"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_zeroSuppression" ref="a1c5afe234b4e0f55c2da524153dbd2ff" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1c5afe234b4e0f55c2da524153dbd2ff">_zeroSuppression</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the zero suppression, that is if you want to apply the 0.4 MIP cut or not <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a12a78cade56b09367209139fac783c14"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_filterDeadCells" ref="a12a78cade56b09367209139fac783c14" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a12a78cade56b09367209139fac783c14">_filterDeadCells</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the filtering of dead cells <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0c500325fa0048790722ea2526a234e6"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_filterDefaultCells" ref="a0c500325fa0048790722ea2526a234e6" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0c500325fa0048790722ea2526a234e6">_filterDefaultCells</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the filgering of default cells <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3d3d2927e61e4c13cbd4342c25687ae"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_doErrorCalculation" ref="af3d3d2927e61e4c13cbd4342c25687ae" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#af3d3d2927e61e4c13cbd4342c25687ae">_doErrorCalculation</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the error calculation <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab60bc164b141b85dc9637dab5d88ff52"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_doWriteOnlyRawAmplitude" ref="ab60bc164b141b85dc9637dab5d88ff52" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab60bc164b141b85dc9637dab5d88ff52">_doWriteOnlyRawAmplitude</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to enable/disable the writing of raw AHCal hits (in ADC counts) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae7a5dacf9857a1f45074aa7668af970a"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_mipCut" ref="ae7a5dacf9857a1f45074aa7668af970a" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae7a5dacf9857a1f45074aa7668af970a">_mipCut</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">value of the MIP cut (default: 0.4 MIPs) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad74cd9ffd52b8b04928f16750382f74"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_mipToGeVFactor" ref="aad74cd9ffd52b8b04928f16750382f74" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#aad74cd9ffd52b8b04928f16750382f74">_mipToGeVFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">conversion factor from MIPs to GeV <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e8a86f294ee86393f3c413bb25fc686"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_correctDefaultGainToLY" ref="a9e8a86f294ee86393f3c413bb25fc686" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>_correctDefaultGainToLY</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a29bf0f8380c4f017874bc0dad44d8a00"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_fixedLY" ref="a29bf0f8380c4f017874bc0dad44d8a00" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><b>_fixedLY</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a470adc298f88f9e78ae24aa67be702d3"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_isDATA" ref="a470adc298f88f9e78ae24aa67be702d3" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a470adc298f88f9e78ae24aa67be702d3">_isDATA</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to switch to DATA processing <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa6bcd2af91b68af922b9b34224a0d8b1"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_isMC" ref="aa6bcd2af91b68af922b9b34224a0d8b1" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#aa6bcd2af91b68af922b9b34224a0d8b1">_isMC</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to switch to MC processing <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a33046a6aada7df9b6a5c369d852c6c23">_isFirstEvent</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">flag to switch to DATA/MC at the first event, the following events should be the same.  <a href="#a33046a6aada7df9b6a5c369d852c6c23"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Processor that does the SiPM calibration. </p>
<p>The calibration is done according to the formula: <img class="formulaInl" alt="$E_{calibrated}=f_{saturation}((E_{raw}-pedestal) \cdot IC/gain) \cdot gain/IC/MIP$" src="form_0.png"/></p>
<p>Please note:</p>
<ul>
<li>this processor does the calibration for both data and Monte Carlo, based on the type of the input collection ("LCGenericObject" for data, and "CalorimeterHit" for Monte Carlo);</li>
<li>for noise creation, the saturation correction is disabled (doSaturationCorrection=false), as well as the ZeroSuppression (ZeroSuppression = false)</li>
<li>for Monte Carlo, the pedestal subtraction is disabled (PedestalSubtraction=false)</li>
</ul>
<dl class="user"><dt><b>processor parameters</b></dt><dd><table border="1" cellspacing="3" cellpadding="3">
<tr>
<td><p>steering file parameter name </p>
</td><td><p>description  </p>
</td></tr>
<tr>
<td><p><b><em> InputCollectionName </em></b></p>
</td><td><p>name of the input collection, with energy in ADC counts </p>
</td></tr>
<tr>
<td><p><b><em> OutputCollectionName </em></b></p>
</td><td><p>name of the output collection, with energy in MIPs </p>
</td></tr>
<tr>
<td><p><b><em> MappingProcessorName </em></b></p>
</td><td><p>name of the mapping processor that provides the necessary Mapper class </p>
</td></tr>
<tr>
<td><p><b><em> SiPMCalibrationsProcessorName </em></b></p>
</td><td><p>name of the processor which provides the SiPM calibrations </p>
</td></tr>
<tr>
<td><p><b><em> SiPMTemperatureProcessorName </em></b></p>
</td><td><p>name of the processor which provides the SiPM temperature </p>
</td></tr>
<tr>
<td><p><b><em> PedestalSubtraction </em></b></p>
</td><td><p>Flag to enable/disable pedestal subtraction </p>
</td></tr>
<tr>
<td><p><b><em> ZeroSuppression </em></b></p>
</td><td><p>Flag to enable/disable zero suppression (intention to apply the MIP cut) </p>
</td></tr>
<tr>
<td><p><b><em> MipCut </em></b></p>
</td><td><p>Value of the MIP cut (default: 0.4 MIPs) </p>
</td></tr>
<tr>
<td><p><b><em> doMipTemperatureCorrection </em></b></p>
</td><td><p>Flag to enable/disable temperature correction of the MIP </p>
</td></tr>
<tr>
<td><p><b><em> doGainTemperatureCorrection </em></b></p>
</td><td><p>Flag to enable/disable temperature correction of the gain </p>
</td></tr>
<tr>
<td><p><b><em> doSaturationCorrection </em></b></p>
</td><td><p>Flag to enable/disable the saturation correction </p>
</td></tr>
<tr>
<td><p><b><em> doErrorCalculation </em></b></p>
</td><td><p>Flag to enable/disable error calculation </p>
</td></tr>
<tr>
<td><p><b><em> filterDeadCells </em></b></p>
</td><td><p>Flag to enable/disable the filtering of dead cells </p>
</td></tr>
<tr>
<td><p><b><em> filterDefaultCells </em></b></p>
</td><td><p>Flag to enable/disable the filtering of default dead cells </p>
</td></tr>
</table>
</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd><a href="mailto:angela-isabela.lucaci-timoce@desy.de">angela-isabela.lucaci-timoce@desy.de</a> </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>0.2 </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>May 2010 </dd></dl>

<p>Definition at line <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00053">53</a> of file <a class="el" href="SiPMCalibrateProcessor_8hh_source.html">SiPMCalibrateProcessor.hh</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a21e550aa165c9a32c585642c91f5b436"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::calibrateEnergyAndFillOutputCollections" ref="a21e550aa165c9a32c585642c91f5b436" args="(SiPMCalibrations *calibration, const float rawEnergy, LCCollection *ahcHitOutputCol, LCCollection *ahcAmplOutputCol, LCRelationNavigator &amp;relationNavigator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CALICE::SiPMCalibrateProcessor::calibrateEnergyAndFillOutputCollections </td>
          <td>(</td>
          <td class="paramtype">SiPMCalibrations *&nbsp;</td>
          <td class="paramname"> <em>calibration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&nbsp;</td>
          <td class="paramname"> <em>rawEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LCCollection *&nbsp;</td>
          <td class="paramname"> <em>ahcHitOutputCol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LCCollection *&nbsp;</td>
          <td class="paramname"> <em>ahcAmplOutputCol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LCRelationNavigator &amp;&nbsp;</td>
          <td class="paramname"> <em>relationNavigator</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calibrate the energy (convert from energy in ADC counts to energy in MIPs). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>calibration</em>&nbsp;</td><td>calibration of the current SiPM </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rawEnergy</em>&nbsp;</td><td>raw energy, in ADC counts </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ahcHitOutputCol</em>&nbsp;</td><td>the AHC hit output collection, of type CalorimeterHit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ahcAmplOutputCol</em>&nbsp;</td><td>the AHC amplitude output collection, of type LCGenericObject </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>relationNavigator</em>&nbsp;</td><td>navigator through the relation between CalorimeterHit and AhcAmplitude </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00454">454</a> of file <a class="el" href="SiPMCalibrateProcessor_8cc_source.html">SiPMCalibrateProcessor.cc</a>.</p>

<p>References <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00103">_ahcHitOutputColName</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00111">_cellDescriptions</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00116">_createSimRecRelation</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00137">_doErrorCalculation</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00131">_doGainTempCorr</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00130">_doMipTempCorr</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00132">_doSaturationCorr</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00114">_energyScaleFactor</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00135">_filterDeadCells</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00136">_filterDefaultCells</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00124">_mapper</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00140">_mipCut</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00141">_mipToGeVFactor</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00129">_pedestalSubtraction</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00118">_recoContainer</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00113">_scaleEnergy</a>, and <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00133">_zeroSuppression</a>.</p>

<p>Referenced by <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00214">processEvent()</a>.</p>

</div>
</div>
<a class="anchor" id="ae71fa4bb6335fbb7ee61ab5d8754e152"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::processEvent" ref="ae71fa4bb6335fbb7ee61ab5d8754e152" args="(LCEvent *evt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CALICE::SiPMCalibrateProcessor::processEvent </td>
          <td>(</td>
          <td class="paramtype">LCEvent *&nbsp;</td>
          <td class="paramname"> <em>evt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process event (the working horse). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>evt</em>&nbsp;</td><td>event to be processed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00214">214</a> of file <a class="el" href="SiPMCalibrateProcessor_8cc_source.html">SiPMCalibrateProcessor.cc</a>.</p>

<p>References <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00104">_ahcAmplOutputColName</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00103">_ahcHitOutputColName</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00126">_calibContainer</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00116">_createSimRecRelation</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00138">_doWriteOnlyRawAmplitude</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00105">_hitAmplRelationColName</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00102">_inputColName</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00146">_isDATA</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00148">_isFirstEvent</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00147">_isMC</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00124">_mapper</a>, <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00118">_recoContainer</a>, and <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00454">calibrateEnergyAndFillOutputCollections()</a>.</p>

</div>
</div>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="a33046a6aada7df9b6a5c369d852c6c23"></a><!-- doxytag: member="CALICE::SiPMCalibrateProcessor::_isFirstEvent" ref="a33046a6aada7df9b6a5c369d852c6c23" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classCALICE_1_1SiPMCalibrateProcessor.html#a33046a6aada7df9b6a5c369d852c6c23">CALICE::SiPMCalibrateProcessor::_isFirstEvent</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>flag to switch to DATA/MC at the first event, the following events should be the same. </p>

<p>Definition at line <a class="el" href="SiPMCalibrateProcessor_8hh_source.html#l00148">148</a> of file <a class="el" href="SiPMCalibrateProcessor_8hh_source.html">SiPMCalibrateProcessor.hh</a>.</p>

<p>Referenced by <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00164">init()</a>, and <a class="el" href="SiPMCalibrateProcessor_8cc_source.html#l00214">processEvent()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="SiPMCalibrateProcessor_8hh_source.html">SiPMCalibrateProcessor.hh</a></li>
<li><a class="el" href="SiPMCalibrateProcessor_8cc_source.html">SiPMCalibrateProcessor.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Dec 2017 for RECOSIPM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
