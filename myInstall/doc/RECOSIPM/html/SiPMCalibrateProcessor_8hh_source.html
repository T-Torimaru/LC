<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RECOSIPM: SiPMCalibrateProcessor.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_f98b43a53f5533225f05987ae358305b.html">calice_reco</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_01780ac29724157a4922dcd586d6082b.html">recoSiPM</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_c3d352f5158c78b0c23f5f807db2ef1c.html">include</a>
  </div>
</div>
<div class="contents">
<h1>SiPMCalibrateProcessor.hh</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef SiPMCalibrateProcessor_h</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define SiPMCalibrateProcessor_h 1</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;lcio.h&quot;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;marlin/Processor.h&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;IMPL/CalorimeterHitImpl.h&quot;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;UTIL/LCRelationNavigator.h&quot;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;SiPMCalibrationsProcessor.hh&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;Mapper.hh&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;AhcMapper.hh&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;AhcAmplitude.hh&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;AhcTempProvider.hh&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">namespace </span>CALICE
<a name="l00017"></a>00017 {
<a name="l00053"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html">00053</a>   <span class="keyword">class </span><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html" title="Processor that does the SiPM calibration.">SiPMCalibrateProcessor</a>: <span class="keyword">public</span> marlin::Processor
<a name="l00054"></a>00054   {
<a name="l00055"></a>00055   <span class="keyword">public</span>:
<a name="l00058"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#afcf5d46a36704ca28d4b396e3c6c880c">00058</a>     <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html" title="Processor that does the SiPM calibration.">SiPMCalibrateProcessor</a> *<a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#afcf5d46a36704ca28d4b396e3c6c880c" title="Return a new instance of this processor.">newProcessor</a>()
<a name="l00059"></a>00059     {
<a name="l00060"></a>00060       <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html" title="Processor that does the SiPM calibration.">SiPMCalibrateProcessor</a>;
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062 
<a name="l00065"></a>00065     <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a3bb0d0e2676910428b75c7b8b80ec87a" title="Default constructor.">SiPMCalibrateProcessor</a>();
<a name="l00066"></a>00066 
<a name="l00069"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a428372dc991fcf2593166951c3f0365c">00069</a>     <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a428372dc991fcf2593166951c3f0365c" title="Destructor.">~SiPMCalibrateProcessor</a>(){};
<a name="l00070"></a>00070 
<a name="l00073"></a>00073     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aab2cba3af1a694e91a0574ffe20275c7" title="Initialise variables, if needed.">init</a>();
<a name="l00074"></a>00074 
<a name="l00078"></a>00078     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae71fa4bb6335fbb7ee61ab5d8754e152" title="Process event (the working horse).">processEvent</a>(LCEvent *evt);
<a name="l00079"></a>00079 
<a name="l00082"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a29f890dd2812216940bc4e4a1534da3d">00082</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a29f890dd2812216940bc4e4a1534da3d" title="Function called after all events have been processed, for cleanup.">end</a>(){};
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="keyword">protected</span>:
<a name="l00092"></a>00092     <span class="keywordtype">void</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a21e550aa165c9a32c585642c91f5b436" title="Calibrate the energy (convert from energy in ADC counts to energy in MIPs).">calibrateEnergyAndFillOutputCollections</a>(SiPMCalibrations* calibration, 
<a name="l00093"></a>00093                                                  <span class="keyword">const</span> <span class="keywordtype">float</span> rawEnergy,
<a name="l00094"></a>00094                                                  LCCollection* ahcHitOutputCol,
<a name="l00095"></a>00095                                                  LCCollection* ahcAmplOutputCol,
<a name="l00096"></a>00096                                                  LCRelationNavigator &amp;relationNavigator);
<a name="l00097"></a>00097     <span class="keywordtype">void</span> checkHitAmplRelation(LCEvent *evt);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="keywordtype">void</span> createSimRecRelation(LCEvent *evt);
<a name="l00100"></a>00100      
<a name="l00101"></a>00101   <span class="keyword">protected</span>:
<a name="l00102"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a57a43fb9e621a67f048f8d7e3eb422fc">00102</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a57a43fb9e621a67f048f8d7e3eb422fc" title="name of the input collection">_inputColName</a>;                
<a name="l00103"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aab19ab03aed4e1d2c55517553b01a7bf">00103</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aab19ab03aed4e1d2c55517553b01a7bf" title="name of the output AHC hit collection">_ahcHitOutputColName</a>;         
<a name="l00104"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab050d98ccbef256701d52f6bcdbe7360">00104</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab050d98ccbef256701d52f6bcdbe7360" title="name of the output AHC amplitude collection">_ahcAmplOutputColName</a>;        
<a name="l00105"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a48052d44b45a93f7d1e247e844f311b6">00105</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a48052d44b45a93f7d1e247e844f311b6" title="name of the LCRelation collection between CalorimeterHit and AhcAmplitude">_hitAmplRelationColName</a>;      
<a name="l00106"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a17f68ea31684ff76170b3878eefb1558">00106</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a17f68ea31684ff76170b3878eefb1558" title="name of the processor which provides the mapping">_mappingProcessorName</a>;        
<a name="l00107"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0b8de01a32b442f302706d5678b0bed7">00107</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0b8de01a32b442f302706d5678b0bed7" title="name of the processor which provides the SiPM calibrations">_calibProcessorName</a>;          
<a name="l00108"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad57628decfdca245ff0bc4466e398d2f">00108</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad57628decfdca245ff0bc4466e398d2f" title="name of the processor which provides the SiPM temperature">_temperatureProcessorName</a>;    
<a name="l00110"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a7470eb03aa80ec18c2bcb3bff172411d">00110</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a7470eb03aa80ec18c2bcb3bff172411d" title="name of the processor which provides the cells description">_cellDescriptionProcessorName</a>; 
<a name="l00111"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a008a04e60e994e7f5a60e4752808d4cf">00111</a>     MappedContainer&lt;CellDescription&gt; *<a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a008a04e60e994e7f5a60e4752808d4cf" title="mapped container of cells description">_cellDescriptions</a>; 
<a name="l00113"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2d1cc15e62943ab55fe09f85a035e0a8">00113</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2d1cc15e62943ab55fe09f85a035e0a8" title="flag to enable/disable the scaling of the hits energy">_scaleEnergy</a>;                                   
<a name="l00114"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1bb566afa9919856a28d3e0496d67236">00114</a>     <span class="keywordtype">float</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1bb566afa9919856a28d3e0496d67236" title="factor to scale the hits energy">_energyScaleFactor</a>;                            
<a name="l00116"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a3901432aa67fe2cc8045eb1e33f77c18">00116</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a3901432aa67fe2cc8045eb1e33f77c18" title="flag to disable/enable the creation of an LCRelation between the Mokka SimCalorimeterHits...">_createSimRecRelation</a>;                           
<a name="l00118"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad95f8f4f5a8053e41cd19f10869f6308">00118</a>     MappedContainer&lt;CalorimeterHitImpl&gt;  *<a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ad95f8f4f5a8053e41cd19f10869f6308" title="mapped container of reconstructed AHCAL hits">_recoContainer</a>; 
<a name="l00119"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ace988b5155d638e3a813a7b2a72bbe96">00119</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ace988b5155d638e3a813a7b2a72bbe96" title="name of collection containing SimCalorimeterHits">_simHitColName</a>;                           
<a name="l00120"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a919e77aed15f7167dbdc8636341b26ad">00120</a>     std::string <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a919e77aed15f7167dbdc8636341b26ad" title="name of the relation between Mokka SimCalorimeterHits and reconstructed CalorimeterHits...">_simRecRelationColName</a>;                   
<a name="l00124"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a02bb58794a7bfaade36b8ea48174a4b1">00124</a>     <span class="keyword">const</span> Mapper* <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a02bb58794a7bfaade36b8ea48174a4b1" title="the mapper">_mapper</a>; 
<a name="l00126"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a40e1e74a8da4c3033f4781f466c447fd">00126</a>     MappedContainer&lt;SiPMCalibrations&gt; *<a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a40e1e74a8da4c3033f4781f466c447fd" title="mapped container of SiPM calibrations">_calibContainer</a>;      
<a name="l00127"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1b48a88d42d7f14a0f70b820765b5ade">00127</a>     MappedContainer&lt;SimpleValue&gt;      *<a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1b48a88d42d7f14a0f70b820765b5ade" title="mapped container of cells temperature">_temperatureContainer</a>;
<a name="l00129"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a62cbf93050afc1ee6e5c7f82fd1f3e66">00129</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a62cbf93050afc1ee6e5c7f82fd1f3e66" title="flag to enable/disable pedestal subtraction">_pedestalSubtraction</a>;     
<a name="l00130"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae71be6f56269b829919d429f1a85e3f8">00130</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae71be6f56269b829919d429f1a85e3f8" title="flag to enable/disable the temperature correction of the MIP">_doMipTempCorr</a>;           
<a name="l00131"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2228aa6db6d857d46ce8309bfa4e7026">00131</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a2228aa6db6d857d46ce8309bfa4e7026" title="flag to enable/disable the temperature correction of the gain">_doGainTempCorr</a>;          
<a name="l00132"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#adda23df94c9acdcc5374d17bb956dfcc">00132</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#adda23df94c9acdcc5374d17bb956dfcc" title="flag to enable/disable the saturation correction">_doSaturationCorr</a>;        
<a name="l00133"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1c5afe234b4e0f55c2da524153dbd2ff">00133</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a1c5afe234b4e0f55c2da524153dbd2ff" title="flag to enable/disable the zero suppression, that is if you want to apply the 0.4...">_zeroSuppression</a>;         
<a name="l00135"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a12a78cade56b09367209139fac783c14">00135</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a12a78cade56b09367209139fac783c14" title="flag to enable/disable the filtering of dead cells">_filterDeadCells</a>;         
<a name="l00136"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0c500325fa0048790722ea2526a234e6">00136</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a0c500325fa0048790722ea2526a234e6" title="flag to enable/disable the filgering of default cells">_filterDefaultCells</a>;      
<a name="l00137"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#af3d3d2927e61e4c13cbd4342c25687ae">00137</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#af3d3d2927e61e4c13cbd4342c25687ae" title="flag to enable/disable the error calculation">_doErrorCalculation</a>;      
<a name="l00138"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab60bc164b141b85dc9637dab5d88ff52">00138</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ab60bc164b141b85dc9637dab5d88ff52" title="flag to enable/disable the writing of raw AHCal hits (in ADC counts)">_doWriteOnlyRawAmplitude</a>; 
<a name="l00140"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae7a5dacf9857a1f45074aa7668af970a">00140</a>     <span class="keywordtype">float</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#ae7a5dacf9857a1f45074aa7668af970a" title="value of the MIP cut (default: 0.4 MIPs)">_mipCut</a>;             
<a name="l00141"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aad74cd9ffd52b8b04928f16750382f74">00141</a>     <span class="keywordtype">float</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aad74cd9ffd52b8b04928f16750382f74" title="conversion factor from MIPs to GeV">_mipToGeVFactor</a>;     
<a name="l00143"></a>00143     <span class="keywordtype">bool</span>  _correctDefaultGainToLY; 
<a name="l00144"></a>00144     <span class="keywordtype">float</span> _fixedLY;
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a470adc298f88f9e78ae24aa67be702d3">00146</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a470adc298f88f9e78ae24aa67be702d3" title="flag to switch to DATA processing">_isDATA</a>;       
<a name="l00147"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aa6bcd2af91b68af922b9b34224a0d8b1">00147</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#aa6bcd2af91b68af922b9b34224a0d8b1" title="flag to switch to MC processing">_isMC</a>;         
<a name="l00148"></a><a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a33046a6aada7df9b6a5c369d852c6c23">00148</a>     <span class="keywordtype">bool</span> <a class="code" href="classCALICE_1_1SiPMCalibrateProcessor.html#a33046a6aada7df9b6a5c369d852c6c23" title="flag to switch to DATA/MC at the first event, the following events should be the...">_isFirstEvent</a>; 
<a name="l00150"></a>00150   };<span class="comment">/*end of class SiPMCalibrateProcessor*/</span>
<a name="l00151"></a>00151   
<a name="l00152"></a>00152 }<span class="comment">/*end of namespace CALICE*/</span>
<a name="l00153"></a>00153 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Dec 2017 for RECOSIPM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
